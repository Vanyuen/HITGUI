# çƒ­æ¸©å†·åˆ†æè¡¨(ä¼˜åŒ–ç‰ˆ) - å­—æ®µè¯¦ç»†è¯´æ˜

> **æ•°æ®æ¨¡å‹ï¼š** `HIT_DLT_RedCombinationsHotWarmColdOptimized`
> **ä»£ç ä½ç½®ï¼š** `src/server/server.js` line 114-157
> **è®¾è®¡ç›®çš„ï¼š** å‹ç¼©å­˜å‚¨ï¼ŒèŠ‚çœ99.7%ç©ºé—´ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½

---

## ä¸€ã€æ ¸å¿ƒå­—æ®µ

### 1. `base_issue` (åŸºå‡†æœŸå·)

**ç±»å‹ï¼š** String (å¿…å¡«)

**è¯´æ˜ï¼š** ç”¨äºè®¡ç®—çƒ­æ¸©å†·çš„åŸºå‡†æœŸå·ï¼Œå³è·å–é—æ¼æ•°æ®çš„æœŸå·ã€‚

**ç¤ºä¾‹ï¼š** `"24120"`

**ä¸šåŠ¡é€»è¾‘ï¼š**
- ç³»ç»Ÿä¼šè¯»å–è¯¥æœŸå·çš„é—æ¼æ•°æ®ï¼ˆ`DLTRedMissing`è¡¨ï¼‰
- åŸºäºé—æ¼å€¼åˆ¤æ–­æ¯ä¸ªå·ç çš„çƒ­æ¸©å†·çŠ¶æ€
- é€šå¸¸ä¸º `target_issue - 1`

**å…³è”ï¼š**
```javascript
// è·å–åŸºå‡†æœŸçš„é—æ¼æ•°æ®
const missingData = await DLTRedMissing.findOne({ Issue: base_issue });
```

---

### 2. `target_issue` (ç›®æ ‡æœŸå·)

**ç±»å‹ï¼š** String (å¿…å¡«)

**è¯´æ˜ï¼š** é¢„æµ‹çš„ç›®æ ‡æœŸå·ï¼Œå³è¦ä¸ºå“ªä¸€æœŸç”Ÿæˆçƒ­æ¸©å†·åˆ†ææ•°æ®ã€‚

**ç¤ºä¾‹ï¼š** `"24121"`

**ä¸šåŠ¡é€»è¾‘ï¼š**
- ç”¨æˆ·è¿›è¡Œç»„åˆé¢„æµ‹æ—¶æŒ‡å®šçš„æœŸå·
- ä¸€ä¸ªç›®æ ‡æœŸå·å¯¹åº”ä¸€ä»½å®Œæ•´çš„çƒ­æ¸©å†·åˆ†ææ•°æ®
- å¦‚æœè¯¥æœŸå·²å¼€å¥–ï¼Œè¿˜ä¼šåŒ…å«å‘½ä¸­åˆ†æ

**ç´¢å¼•ï¼š**
- å•å­—æ®µç´¢å¼•ï¼š`{ target_issue: 1 }`
- è”åˆå”¯ä¸€ç´¢å¼•ï¼š`{ base_issue: 1, target_issue: 1 }`ï¼ˆä¸€ä¸ªåŸºå‡†æœŸ+ç›®æ ‡æœŸç»„åˆåªèƒ½æœ‰ä¸€æ¡è®°å½•ï¼‰

---

### 3. `hot_warm_cold_data` (çƒ­æ¸©å†·åˆ†ç»„æ•°æ®) â­æ ¸å¿ƒå­—æ®µ

**ç±»å‹ï¼š** Map<String, Array<Number>>

**è¯´æ˜ï¼š** æŒ‰çƒ­æ¸©å†·æ¯”åˆ†ç»„å­˜å‚¨çš„ç»„åˆIDæ•°ç»„ï¼Œè¿™æ˜¯ä¼˜åŒ–å­˜å‚¨çš„å…³é”®ã€‚

**æ•°æ®ç»“æ„ï¼š**
```javascript
{
  "3:2:0": [1, 15, 89, 234, 567, ...],      // çƒ­æ¸©å†·æ¯”ä¸º3:2:0çš„æ‰€æœ‰ç»„åˆID
  "2:2:1": [2, 20, 102, 398, 654, ...],     // çƒ­æ¸©å†·æ¯”ä¸º2:2:1çš„æ‰€æœ‰ç»„åˆID
  "2:3:0": [5, 32, 156, 489, 702, ...],     // çƒ­æ¸©å†·æ¯”ä¸º2:3:0çš„æ‰€æœ‰ç»„åˆID
  "3:1:1": [8, 45, 201, 521, 798, ...],     // çƒ­æ¸©å†·æ¯”ä¸º3:1:1çš„æ‰€æœ‰ç»„åˆID
  // ... æ›´å¤šçƒ­æ¸©å†·æ¯”
}
```

**Key (é”®)ï¼š** çƒ­æ¸©å†·æ¯”å­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸º `"çƒ­å·æ•°:æ¸©å·æ•°:å†·å·æ•°"`
- ç¤ºä¾‹ï¼š`"3:2:0"` è¡¨ç¤º3ä¸ªçƒ­å·ã€2ä¸ªæ¸©å·ã€0ä¸ªå†·å·
- å¯èƒ½çš„å–å€¼ï¼šç†è®ºä¸Šæœ‰21ç§ç»„åˆ (0:0:5, 0:1:4, ... 5:0:0)

**Value (å€¼)ï¼š** ç»„åˆIDæ•°ç»„ `[Number]`
- æ¯ä¸ªNumberæ˜¯ `DLTRedCombinations` è¡¨ä¸­çš„ `combination_id` (1-324632)
- æ•°ç»„é•¿åº¦è¡¨ç¤ºè¯¥çƒ­æ¸©å†·æ¯”æœ‰å¤šå°‘ä¸ªç»„åˆ

**å­˜å‚¨ä¼˜åŠ¿ï¼š**

**ä¼ ç»Ÿæ–¹å¼ï¼š**
```javascript
// éœ€è¦ 324,632 æ¡è®°å½•
{ combination_id: 1, hot_warm_cold_ratio: "3:2:0", ... }
{ combination_id: 2, hot_warm_cold_ratio: "2:2:1", ... }
{ combination_id: 3, hot_warm_cold_ratio: "3:2:0", ... }
// ... 324,632 æ¡
```

**ä¼˜åŒ–æ–¹å¼ï¼š**
```javascript
// åªéœ€ 1 æ¡è®°å½•
{
  base_issue: "24120",
  target_issue: "24121",
  hot_warm_cold_data: {
    "3:2:0": [1, 3, 15, ...],  // å‡è®¾80,000ä¸ªç»„åˆ
    "2:2:1": [2, 8, 23, ...],  // å‡è®¾90,000ä¸ªç»„åˆ
    // ... çº¦15-20ä¸ªä¸åŒçš„çƒ­æ¸©å†·æ¯”
  }
}
```

**æŸ¥è¯¢ç¤ºä¾‹ï¼š** (server.js line 7859)
```javascript
// éå†æ‰€æœ‰çƒ­æ¸©å†·æ¯”
for (const [ratio, combinationIds] of optimizedData.hot_warm_cold_data.entries()) {
    // ratio: "3:2:0"
    // combinationIds: [1, 15, 89, 234, ...]

    // æ£€æŸ¥æ˜¯å¦è¢«ç”¨æˆ·æ’é™¤
    if (excludedRatios.includes(ratio)) continue;

    // æ”¶é›†ç¬¦åˆæ¡ä»¶çš„ç»„åˆID
    combinationIds.forEach(id => validCombinationIds.add(id));
}
```

---

### 4. `total_combinations` (æ€»ç»„åˆæ•°)

**ç±»å‹ï¼š** Number (å¿…å¡«)

**è¯´æ˜ï¼š** è¯¥æœŸçƒ­æ¸©å†·åˆ†æçš„æ€»ç»„åˆæ•°ï¼Œé€šå¸¸ä¸º 324,632ï¼ˆå¤§ä¹é€å‰åŒºæ‰€æœ‰5é€‰35ç»„åˆï¼‰ã€‚

**ç”¨é€”ï¼š**
- å¿«é€Ÿç»Ÿè®¡éªŒè¯
- æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- å‰ç«¯æ˜¾ç¤ºæ€»æ•°

**è®¡ç®—ï¼š**
```javascript
total_combinations = Object.values(hot_warm_cold_data)
    .reduce((sum, arr) => sum + arr.length, 0);
```

**ç¤ºä¾‹ï¼š**
```javascript
{
  total_combinations: 324632,
  statistics: {
    ratio_counts: {
      "3:2:0": 78456,
      "2:2:1": 89234,
      "2:3:0": 67890,
      // ... æ€»å’Œ = 324632
    }
  }
}
```

---

## äºŒã€å‘½ä¸­åˆ†æå­—æ®µ (hit_analysis)

> **è¯´æ˜ï¼š** å½“ç›®æ ‡æœŸå·å·²å¼€å¥–æ—¶ï¼Œç³»ç»Ÿä¼šè®¡ç®—æ‰€æœ‰ç»„åˆä¸å®é™…å¼€å¥–ç»“æœçš„å‘½ä¸­æƒ…å†µã€‚

### 5. `hit_analysis` (å‘½ä¸­åˆ†æå¯¹è±¡)

**ç±»å‹ï¼š** Object

**ç»“æ„ï¼š**
```javascript
{
  target_winning_reds: [Number],      // å®é™…å¼€å¥–çº¢çƒ
  target_winning_blues: [Number],     // å®é™…å¼€å¥–è“çƒ
  red_hit_data: Map<String, [Number]>, // å‘½ä¸­åˆ†ç»„æ•°æ®
  hit_statistics: Object,             // å‘½ä¸­ç»Ÿè®¡
  is_drawn: Boolean                   // æ˜¯å¦å·²å¼€å¥–
}
```

---

#### 5.1 `target_winning_reds` (å®é™…å¼€å¥–çº¢çƒ)

**ç±»å‹ï¼š** Array<Number> (é•¿åº¦5)

**è¯´æ˜ï¼š** ç›®æ ‡æœŸå·çš„å®é™…å¼€å¥–çº¢çƒå·ç ï¼ˆå‡åºæ’åˆ—ï¼‰ã€‚

**ç¤ºä¾‹ï¼š** `[5, 12, 18, 23, 31]`

**ç”¨é€”ï¼š**
- è®¡ç®—æ¯ä¸ªç»„åˆå‘½ä¸­äº†å‡ ä¸ªçº¢çƒ
- å±•ç¤ºåœ¨å‰ç«¯ä¾›ç”¨æˆ·å¯¹æ¯”

---

#### 5.2 `target_winning_blues` (å®é™…å¼€å¥–è“çƒ)

**ç±»å‹ï¼š** Array<Number> (é•¿åº¦2)

**è¯´æ˜ï¼š** ç›®æ ‡æœŸå·çš„å®é™…å¼€å¥–è“çƒå·ç ï¼ˆå‡åºæ’åˆ—ï¼‰ã€‚

**ç¤ºä¾‹ï¼š** `[3, 9]`

**ç”¨é€”ï¼š**
- è“çƒå‘½ä¸­åˆ†æ
- å®Œæ•´å¥–çº§åˆ¤å®š

---

#### 5.3 `red_hit_data` (çº¢çƒå‘½ä¸­åˆ†ç»„æ•°æ®) â­å…³é”®å­—æ®µ

**ç±»å‹ï¼š** Map<String, Array<Number>>

**è¯´æ˜ï¼š** æŒ‰çº¢çƒå‘½ä¸­æ•°é‡åˆ†ç»„å­˜å‚¨çš„ç»„åˆIDæ•°ç»„ã€‚

**æ•°æ®ç»“æ„ï¼š**
```javascript
{
  "0": [8, 45, 102, 389, ...],      // å‘½ä¸­0ä¸ªçº¢çƒçš„ç»„åˆID
  "1": [12, 67, 234, 512, ...],     // å‘½ä¸­1ä¸ªçº¢çƒçš„ç»„åˆID
  "2": [3, 89, 345, 678, ...],      // å‘½ä¸­2ä¸ªçº¢çƒçš„ç»„åˆID
  "3": [23, 156, 489, 801, ...],    // å‘½ä¸­3ä¸ªçº¢çƒçš„ç»„åˆID
  "4": [98, 234, 567, ...],         // å‘½ä¸­4ä¸ªçº¢çƒçš„ç»„åˆID
  "5": [1234, 5678, ...]            // å‘½ä¸­5ä¸ªçº¢çƒçš„ç»„åˆID (ç½•è§)
}
```

**Key (é”®)ï¼š** å‘½ä¸­æ•°é‡å­—ç¬¦ä¸² `"0"` åˆ° `"5"`

**Value (å€¼)ï¼š** ç»„åˆIDæ•°ç»„

**åº”ç”¨åœºæ™¯ï¼š**
```javascript
// æŸ¥è¯¢å‘½ä¸­2ä¸ªä»¥ä¸Šçº¢çƒçš„æ‰€æœ‰ç»„åˆ
const hit2Plus = [
    ...red_hit_data.get("2"),
    ...red_hit_data.get("3"),
    ...red_hit_data.get("4"),
    ...red_hit_data.get("5")
];

// å‰ç«¯æ˜¾ç¤ºï¼š"æ‚¨çš„ç»„åˆå‘½ä¸­äº†3ä¸ªçº¢çƒï¼åœ¨æœ¬æœŸæ’åå‰15%"
```

---

#### 5.4 `hit_statistics` (å‘½ä¸­ç»Ÿè®¡)

**ç±»å‹ï¼š** Object

**è¯´æ˜ï¼š** å„å‘½ä¸­æ•°é‡çš„ç»„åˆç»Ÿè®¡ï¼Œç”¨äºå¿«é€ŸæŸ¥çœ‹åˆ†å¸ƒæƒ…å†µã€‚

**å­—æ®µï¼š**
```javascript
{
  hit_0: Number,  // å‘½ä¸­0ä¸ªçš„ç»„åˆæ•°
  hit_1: Number,  // å‘½ä¸­1ä¸ªçš„ç»„åˆæ•°
  hit_2: Number,  // å‘½ä¸­2ä¸ªçš„ç»„åˆæ•°
  hit_3: Number,  // å‘½ä¸­3ä¸ªçš„ç»„åˆæ•°
  hit_4: Number,  // å‘½ä¸­4ä¸ªçš„ç»„åˆæ•°
  hit_5: Number   // å‘½ä¸­5ä¸ªçš„ç»„åˆæ•° (ä¸€ç­‰å¥–å‰åŒº)
}
```

**ç¤ºä¾‹æ•°æ®ï¼š**
```javascript
{
  hit_0: 132456,   // 40.8% æœªå‘½ä¸­
  hit_1: 145678,   // 44.9% å‘½ä¸­1ä¸ª
  hit_2: 38234,    // 11.8% å‘½ä¸­2ä¸ª
  hit_3: 7456,     // 2.3% å‘½ä¸­3ä¸ª
  hit_4: 756,      // 0.23% å‘½ä¸­4ä¸ª
  hit_5: 52        // 0.016% å‘½ä¸­5ä¸ª (52ä¸ªç»„åˆå¯èƒ½ä¸­ä¸€ç­‰å¥–)
}
// æ€»è®¡: 324,632 ç»„åˆ
```

**éªŒè¯å…¬å¼ï¼š**
```javascript
hit_0 + hit_1 + hit_2 + hit_3 + hit_4 + hit_5 === total_combinations
```

**åº”ç”¨åœºæ™¯ï¼š**
- å‰ç«¯å±•ç¤ºå‘½ä¸­ç‡åˆ†å¸ƒå›¾è¡¨
- è¯„ä¼°é¢„æµ‹ç³»ç»Ÿçš„å‡†ç¡®æ€§
- å†å²å›æµ‹åˆ†æ

---

#### 5.5 `is_drawn` (æ˜¯å¦å·²å¼€å¥–)

**ç±»å‹ï¼š** Boolean (é»˜è®¤false)

**è¯´æ˜ï¼š** æ ‡è¯†ç›®æ ‡æœŸå·æ˜¯å¦å·²å¼€å¥–ï¼Œå†³å®šæ˜¯å¦æœ‰å‘½ä¸­åˆ†ææ•°æ®ã€‚

**å–å€¼ï¼š**
- `true`ï¼šå·²å¼€å¥–ï¼ŒåŒ…å«å®Œæ•´å‘½ä¸­åˆ†æ
- `false`ï¼šæœªå¼€å¥–ï¼Œå‘½ä¸­åˆ†æå­—æ®µä¸ºç©º

**é€»è¾‘ï¼š**
```javascript
if (is_drawn === true) {
    // å¯ä»¥å±•ç¤ºå‘½ä¸­åˆ†æ
    console.log(`å‘½ä¸­5ä¸ªçº¢çƒçš„ç»„åˆ: ${red_hit_data.get("5").length}ä¸ª`);
} else {
    // æ˜¾ç¤º"ç­‰å¾…å¼€å¥–"
    console.log("è¯¥æœŸå°šæœªå¼€å¥–ï¼Œæš‚æ— å‘½ä¸­æ•°æ®");
}
```

---

## ä¸‰ã€ç»Ÿè®¡å­—æ®µ (statistics)

### 6. `statistics` (ç»Ÿè®¡ä¿¡æ¯å¯¹è±¡)

**ç±»å‹ï¼š** Object

**è¯´æ˜ï¼š** å­˜å‚¨å„ç§ç»Ÿè®¡ä¿¡æ¯ï¼Œæ–¹ä¾¿å‰ç«¯å¿«é€Ÿå±•ç¤ºã€‚

---

#### 6.1 `ratio_counts` (çƒ­æ¸©å†·æ¯”åˆ†å¸ƒç»Ÿè®¡)

**ç±»å‹ï¼š** Map<String, Number>

**è¯´æ˜ï¼š** æ¯ä¸ªçƒ­æ¸©å†·æ¯”å¯¹åº”çš„ç»„åˆæ•°é‡ã€‚

**æ•°æ®ç»“æ„ï¼š**
```javascript
{
  "3:2:0": 78456,    // çƒ­æ¸©å†·æ¯”3:2:0æœ‰78,456ä¸ªç»„åˆ
  "2:2:1": 89234,    // çƒ­æ¸©å†·æ¯”2:2:1æœ‰89,234ä¸ªç»„åˆ
  "2:3:0": 67890,    // çƒ­æ¸©å†·æ¯”2:3:0æœ‰67,890ä¸ªç»„åˆ
  "3:1:1": 45678,
  "2:1:2": 23456,
  "4:1:0": 12345,
  // ... çº¦15-20ä¸ªä¸åŒçš„çƒ­æ¸©å†·æ¯”
}
```

**è®¡ç®—æ–¹æ³•ï¼š**
```javascript
const ratio_counts = new Map();
for (const [ratio, combinationIds] of hot_warm_cold_data.entries()) {
    ratio_counts.set(ratio, combinationIds.length);
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```javascript
// å‰ç«¯å±•ç¤ºçƒ­æ¸©å†·æ¯”åˆ†å¸ƒå›¾è¡¨
const chartData = {
  labels: Array.from(ratio_counts.keys()),
  values: Array.from(ratio_counts.values())
};

// é¥¼å›¾ï¼šæ˜¾ç¤ºå„çƒ­æ¸©å†·æ¯”å æ¯”
// æŸ±çŠ¶å›¾ï¼šæ˜¾ç¤ºå„çƒ­æ¸©å†·æ¯”çš„ç»„åˆæ•°é‡
```

**éªŒè¯ï¼š**
```javascript
// æ‰€æœ‰ratio_countsçš„å€¼ä¹‹å’Œåº”ç­‰äºtotal_combinations
const sum = Array.from(ratio_counts.values()).reduce((a, b) => a + b, 0);
assert(sum === total_combinations); // åº”ä¸º324,632
```

---

## å››ã€å…ƒæ•°æ®å­—æ®µ

### 7. `created_at` (åˆ›å»ºæ—¶é—´)

**ç±»å‹ï¼š** Date (è‡ªåŠ¨ç”Ÿæˆ)

**è¯´æ˜ï¼š** è¯¥æ¡è®°å½•çš„åˆ›å»ºæ—¶é—´æˆ³ã€‚

**ç”¨é€”ï¼š**
- æ•°æ®è¿½æº¯
- æ¸…ç†è¿‡æœŸæ•°æ®
- å±•ç¤º"æ•°æ®æ›´æ–°æ—¶é—´"

**ç¤ºä¾‹ï¼š** `2025-09-29T10:30:15.123Z`

---

## äº”ã€æ•°æ®åº“ç´¢å¼•

### ç´¢å¼•è®¾è®¡

```javascript
// 1. å•å­—æ®µç´¢å¼• - ç”¨äºæŒ‰åŸºå‡†æœŸæŸ¥è¯¢
{ base_issue: 1 }

// 2. å•å­—æ®µç´¢å¼• - ç”¨äºæŒ‰ç›®æ ‡æœŸæŸ¥è¯¢
{ target_issue: 1 }

// 3. è”åˆå”¯ä¸€ç´¢å¼• - ç¡®ä¿ä¸€ä¸ªåŸºå‡†æœŸ+ç›®æ ‡æœŸåªæœ‰ä¸€æ¡è®°å½•
{ base_issue: 1, target_issue: 1 }, { unique: true }
```

**æŸ¥è¯¢ä¼˜åŒ–ï¼š**
```javascript
// å¿«é€ŸæŸ¥è¯¢ - å‘½ä¸­ç´¢å¼•
await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: "24120",
    target_issue: "24121"
});

// æ‰¹é‡æŸ¥è¯¢
await DLTRedCombinationsHotWarmColdOptimized.find({
    target_issue: { $in: ["24121", "24122", "24123"] }
});
```

---

## å…­ã€å®Œæ•´æ•°æ®ç¤ºä¾‹

```javascript
{
  _id: ObjectId("..."),

  // æ ¸å¿ƒå­—æ®µ
  base_issue: "24120",
  target_issue: "24121",
  total_combinations: 324632,

  // çƒ­æ¸©å†·åˆ†ç»„æ•°æ®
  hot_warm_cold_data: {
    "5:0:0": [1, 89, 234, ...],           // 456ä¸ªç»„åˆ
    "4:1:0": [15, 102, 345, ...],         // 12,345ä¸ªç»„åˆ
    "4:0:1": [23, 156, 456, ...],         // 8,901ä¸ªç»„åˆ
    "3:2:0": [5, 67, 201, ...],           // 78,456ä¸ªç»„åˆ â­æœ€å¸¸è§
    "3:1:1": [32, 145, 389, ...],         // 45,678ä¸ªç»„åˆ
    "3:0:2": [8, 178, 423, ...],          // 19,234ä¸ªç»„åˆ
    "2:3:0": [45, 234, 567, ...],         // 67,890ä¸ªç»„åˆ â­æœ€å¸¸è§
    "2:2:1": [12, 189, 501, ...],         // 89,234ä¸ªç»„åˆ â­æœ€å¸¸è§
    "2:1:2": [76, 298, 612, ...],         // 23,456ä¸ªç»„åˆ
    "2:0:3": [98, 312, 678, ...],         // 6,789ä¸ªç»„åˆ
    "1:4:0": [56, 245, 589, ...],         // 34,567ä¸ªç»„åˆ
    "1:3:1": [123, 367, 701, ...],        // 45,678ä¸ªç»„åˆ
    "1:2:2": [145, 456, 789, ...],        // 23,456ä¸ªç»„åˆ
    "1:1:3": [167, 489, 823, ...],        // 8,901ä¸ªç»„åˆ
    "1:0:4": [189, 512, 867, ...],        // 2,345ä¸ªç»„åˆ
    "0:5:0": [201, 534, 901, ...],        // 5,678ä¸ªç»„åˆ
    "0:4:1": [223, 567, 934, ...],        // 3,456ä¸ªç»„åˆ
    "0:3:2": [245, 589, 967, ...],        // 1,234ä¸ªç»„åˆ
    "0:2:3": [267, 612, 987, ...],        // 567ä¸ªç»„åˆ
    "0:1:4": [289, 634, 1001, ...],       // 234ä¸ªç»„åˆ
    "0:0:5": [301, 656, 1023, ...]        // 89ä¸ªç»„åˆ
  },

  // å‘½ä¸­åˆ†ææ•°æ® (å¦‚æœå·²å¼€å¥–)
  hit_analysis: {
    target_winning_reds: [5, 12, 18, 23, 31],   // å®é™…å¼€å¥–
    target_winning_blues: [3, 9],
    is_drawn: true,

    red_hit_data: {
      "0": [8, 45, 102, ...],           // 132,456ä¸ªç»„åˆ
      "1": [12, 67, 234, ...],          // 145,678ä¸ªç»„åˆ
      "2": [3, 89, 345, ...],           // 38,234ä¸ªç»„åˆ
      "3": [23, 156, 489, ...],         // 7,456ä¸ªç»„åˆ
      "4": [98, 234, 567, ...],         // 756ä¸ªç»„åˆ
      "5": [1234, 5678, 9012, ...]      // 52ä¸ªç»„åˆ ğŸ‰
    },

    hit_statistics: {
      hit_0: 132456,  // 40.8%
      hit_1: 145678,  // 44.9%
      hit_2: 38234,   // 11.8%
      hit_3: 7456,    // 2.3%
      hit_4: 756,     // 0.23%
      hit_5: 52       // 0.016%
    }
  },

  // ç»Ÿè®¡ä¿¡æ¯
  statistics: {
    ratio_counts: {
      "5:0:0": 456,
      "4:1:0": 12345,
      "3:2:0": 78456,    // æœ€å¤š
      "2:3:0": 67890,    // ç¬¬äºŒå¤š
      "2:2:1": 89234,    // ç¬¬ä¸‰å¤š
      // ... å…±21ä¸ªå¯èƒ½çš„çƒ­æ¸©å†·æ¯”
    }
  },

  created_at: ISODate("2025-09-29T10:30:15.123Z")
}
```

---

## ä¸ƒã€æ•°æ®å­˜å‚¨å¯¹æ¯”

### ä¼ ç»Ÿæ–¹å¼ (DLTRedCombinationsHotWarmCold)

**è®°å½•æ•°ï¼š** 324,632 æ¡/æœŸ

**å•æ¡è®°å½•ï¼š**
```javascript
{
  base_issue: "24120",
  target_issue: "24121",
  combination_id: 1,
  red_ball_1: 1,
  red_ball_2: 2,
  red_ball_3: 3,
  red_ball_4: 4,
  red_ball_5: 5,
  hot_warm_cold_ratio: "3:2:0",
  hot_count: 3,
  warm_count: 2,
  cold_count: 0,
  created_at: ISODate(...)
}
```

**å­˜å‚¨ç©ºé—´ä¼°ç®—ï¼š**
- æ¯æ¡è®°å½•çº¦ 150 bytes
- 324,632 æ¡ Ã— 150 bytes â‰ˆ **48.7 MB** / æœŸ
- 200æœŸæ•°æ® â‰ˆ **9.74 GB**

---

### ä¼˜åŒ–æ–¹å¼ (DLTRedCombinationsHotWarmColdOptimized)

**è®°å½•æ•°ï¼š** 1 æ¡/æœŸ

**å•æ¡è®°å½•ï¼š** (å¦‚ä¸Šé¢å®Œæ•´ç¤ºä¾‹)

**å­˜å‚¨ç©ºé—´ä¼°ç®—ï¼š**
- æ¯ä¸ªç»„åˆID: 4 bytes (Number)
- 324,632 ä¸ªID Ã— 4 bytes = 1.3 MB
- åŠ ä¸ŠMapé”®ã€ç»Ÿè®¡ä¿¡æ¯ç­‰ â‰ˆ **1.5 MB** / æœŸ
- 200æœŸæ•°æ® â‰ˆ **300 MB**

**å‹ç¼©æ¯”ï¼š** `9.74 GB / 300 MB â‰ˆ 32.5å€` ğŸ‰

---

## å…«ã€æŸ¥è¯¢æ€§èƒ½å¯¹æ¯”

### åœºæ™¯ï¼šæŸ¥è¯¢çƒ­æ¸©å†·æ¯”ä¸º"3:2:0"æˆ–"2:2:1"çš„æ‰€æœ‰ç»„åˆ

**ä¼ ç»Ÿæ–¹å¼ï¼š**
```javascript
// éœ€è¦æ‰«æ 324,632 æ¡è®°å½•
const result = await DLTRedCombinationsHotWarmCold.find({
    base_issue: "24120",
    target_issue: "24121",
    hot_warm_cold_ratio: { $in: ["3:2:0", "2:2:1"] }
});
// è€—æ—¶ï¼š~3-5ç§’
```

**ä¼˜åŒ–æ–¹å¼ï¼š**
```javascript
// åªéœ€è¯»å–1æ¡è®°å½•ï¼Œå†…å­˜ä¸­ç­›é€‰
const data = await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: "24120",
    target_issue: "24121"
});

const combinationIds = [
    ...data.hot_warm_cold_data.get("3:2:0"),
    ...data.hot_warm_cold_data.get("2:2:1")
];
// è€—æ—¶ï¼š~0.5-1ç§’
```

**æ€§èƒ½æå‡ï¼š** 3-5å€ ğŸš€

---

## ä¹ã€å¸¸è§æŸ¥è¯¢æ¨¡å¼

### 1. è·å–æŒ‡å®šçƒ­æ¸©å†·æ¯”çš„ç»„åˆ

```javascript
const data = await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: "24120",
    target_issue: "24121"
});

// è·å–çƒ­æ¸©å†·æ¯”ä¸º"3:2:0"çš„æ‰€æœ‰ç»„åˆID
const combinationIds = data.hot_warm_cold_data.get("3:2:0");
console.log(`æ‰¾åˆ°${combinationIds.length}ä¸ªç»„åˆ`);
```

### 2. æ’é™¤ç‰¹å®šçƒ­æ¸©å†·æ¯”

```javascript
const excludedRatios = ["5:0:0", "0:0:5", "4:1:0"];
const validIds = new Set();

for (const [ratio, ids] of data.hot_warm_cold_data.entries()) {
    if (!excludedRatios.includes(ratio)) {
        ids.forEach(id => validIds.add(id));
    }
}
```

### 3. æŸ¥è¯¢å‘½ä¸­åˆ†æ

```javascript
if (data.hit_analysis.is_drawn) {
    // è·å–å‘½ä¸­3ä¸ªä»¥ä¸Šçº¢çƒçš„ç»„åˆ
    const hit3Plus = [
        ...data.hit_analysis.red_hit_data.get("3"),
        ...data.hit_analysis.red_hit_data.get("4"),
        ...data.hit_analysis.red_hit_data.get("5")
    ];

    console.log(`æœ¬æœŸå…±æœ‰${hit3Plus.length}ä¸ªç»„åˆå‘½ä¸­3ä¸ªä»¥ä¸Šçº¢çƒ`);
}
```

### 4. ç»Ÿè®¡åˆ†æ

```javascript
// æŸ¥çœ‹çƒ­æ¸©å†·æ¯”åˆ†å¸ƒ
console.log("çƒ­æ¸©å†·æ¯”åˆ†å¸ƒï¼š");
for (const [ratio, count] of data.statistics.ratio_counts.entries()) {
    const percentage = (count / data.total_combinations * 100).toFixed(2);
    console.log(`${ratio}: ${count}ä¸ª (${percentage}%)`);
}

// æŸ¥çœ‹å‘½ä¸­åˆ†å¸ƒ
if (data.hit_analysis.is_drawn) {
    console.log("\nå‘½ä¸­åˆ†å¸ƒï¼š");
    const stats = data.hit_analysis.hit_statistics;
    for (let i = 0; i <= 5; i++) {
        const count = stats[`hit_${i}`];
        const percentage = (count / data.total_combinations * 100).toFixed(2);
        console.log(`å‘½ä¸­${i}ä¸ª: ${count}ä¸ª (${percentage}%)`);
    }
}
```

---

## åã€ä¸ä¼ ç»Ÿè¡¨çš„å…¼å®¹æ€§

ç³»ç»Ÿä¿ç•™äº†ä¼ ç»Ÿè¡¨ `DLTRedCombinationsHotWarmCold`ï¼Œç¡®ä¿å‘åå…¼å®¹ã€‚

**ä½¿ç”¨ç­–ç•¥ï¼š**
1. ä¼˜å…ˆä½¿ç”¨ä¼˜åŒ–ç‰ˆè¡¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
2. å›é€€åˆ°ä¼ ç»Ÿè¡¨ï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰

**ä»£ç ç¤ºä¾‹ï¼š** (server.js line 7370)
```javascript
// æ£€æŸ¥ä¼˜åŒ–ç‰ˆæ•°æ®
let hotWarmColdData = await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: baseIssue,
    target_issue: targetIssue
});

if (!hotWarmColdData) {
    // å›é€€åˆ°ä¼ ç»Ÿè¡¨
    return res.status(404).json({
        success: false,
        message: `æœŸå·${targetIssue}çš„ä¼˜åŒ–ç‰ˆçƒ­æ¸©å†·æ•°æ®ä¸å­˜åœ¨ï¼Œè¯·å…ˆç”Ÿæˆæ•°æ®`
    });
}
```

---

## åä¸€ã€æ•°æ®ç”Ÿæˆæµç¨‹

```
1. æ¥æ”¶APIè¯·æ±‚
   POST /api/dlt/generate-hot-warm-cold/:baseIssue/:targetIssue

2. è·å–åŸºå‡†æœŸé—æ¼æ•°æ®
   DLTRedMissing.findOne({ Issue: baseIssue })

3. è¯»å–æ‰€æœ‰çº¢çƒç»„åˆ (324,632ä¸ª)
   DLTRedCombinations.find({})

4. ä¸ºæ¯ä¸ªç»„åˆè®¡ç®—çƒ­æ¸©å†·æ¯”
   â”œâ”€ éå†5ä¸ªçº¢çƒ
   â”œâ”€ æŸ¥è¯¢é—æ¼å€¼
   â”œâ”€ åˆ¤æ–­çƒ­/æ¸©/å†·
   â””â”€ ç”Ÿæˆæ¯”ä¾‹å­—ç¬¦ä¸² "çƒ­:æ¸©:å†·"

5. æŒ‰çƒ­æ¸©å†·æ¯”åˆ†ç»„
   hot_warm_cold_data: {
     "3:2:0": [ç»„åˆIDæ•°ç»„],
     "2:2:1": [ç»„åˆIDæ•°ç»„],
     ...
   }

6. å¦‚æœç›®æ ‡æœŸå·²å¼€å¥–ï¼Œè®¡ç®—å‘½ä¸­åˆ†æ
   â”œâ”€ è·å–å¼€å¥–ç»“æœ
   â”œâ”€ éå†æ‰€æœ‰ç»„åˆ
   â”œâ”€ è®¡ç®—å‘½ä¸­æ•°é‡
   â””â”€ æŒ‰å‘½ä¸­æ•°åˆ†ç»„

7. ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯
   â”œâ”€ ratio_counts
   â”œâ”€ hit_statistics
   â””â”€ total_combinations

8. ä¿å­˜åˆ°æ•°æ®åº“
   DLTRedCombinationsHotWarmColdOptimized.create({...})
```

---

## åäºŒã€æœ€ä½³å®è·µ

### 1. æ•°æ®ç”Ÿæˆå»ºè®®
- æ¯æ¬¡æ–°æœŸå¼€å¥–åç«‹å³ç”Ÿæˆçƒ­æ¸©å†·æ•°æ®
- ä½¿ç”¨æ‰¹é‡ç”ŸæˆAPIä¸€æ¬¡æ€§ç”Ÿæˆæœ€è¿‘200æœŸ
- å®šæœŸæ£€æŸ¥æ•°æ®å®Œæ•´æ€§

### 2. æŸ¥è¯¢ä¼˜åŒ–å»ºè®®
- ä¼˜å…ˆä½¿ç”¨ä¼˜åŒ–ç‰ˆè¡¨
- åˆ©ç”¨ç´¢å¼•æŸ¥è¯¢ (base_issue + target_issue)
- ä½¿ç”¨Setè¿›è¡Œç»„åˆIDå»é‡
- åˆ†é¡µåŠ è½½å¤§é‡ç»“æœ

### 3. å‰ç«¯å±•ç¤ºå»ºè®®
- ä½¿ç”¨å›¾è¡¨å±•ç¤ºçƒ­æ¸©å†·æ¯”åˆ†å¸ƒ
- é«˜äº®æ˜¾ç¤ºå¸¸è§çƒ­æ¸©å†·æ¯”
- å±•ç¤ºå‘½ä¸­åˆ†æï¼ˆå¦‚å·²å¼€å¥–ï¼‰
- æä¾›å¿«æ·ç­›é€‰æŒ‰é’®

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¥æœŸï¼š** 2025-09-29
**ç»´æŠ¤è€…ï¼š** Claude Code
**å‚è€ƒä»£ç ï¼š** `src/server/server.js` line 114-185, 7318-8172