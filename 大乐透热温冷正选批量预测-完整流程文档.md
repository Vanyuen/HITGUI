# å¤§ä¹é€çƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹ - å®Œæ•´æµç¨‹æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æœ€åæ›´æ–°**: 2025-10-31
**åŠŸèƒ½çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å·²å®ç°ï¼Œæ’é™¤æ¡ä»¶å¾…å®Œå–„

---

## ğŸ“š ç›®å½•

1. [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
3. [å®Œæ•´é¢„æµ‹æµç¨‹](#å®Œæ•´é¢„æµ‹æµç¨‹)
4. [æ•°æ®æµè½¬è¯¦è§£](#æ•°æ®æµè½¬è¯¦è§£)
5. [6æ­¥æ­£é€‰ç®—æ³•](#6æ­¥æ­£é€‰ç®—æ³•)
6. [5æ­¥æ’é™¤ç®—æ³•](#5æ­¥æ’é™¤ç®—æ³•)
7. [å‘½ä¸­ç»Ÿè®¡åˆ†æ](#å‘½ä¸­ç»Ÿè®¡åˆ†æ)
8. [Excelå¯¼å‡º](#excelå¯¼å‡º)
9. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
10. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ğŸ“– åŠŸèƒ½æ¦‚è¿°

### æ ¸å¿ƒç†å¿µ

çƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹æ˜¯ä¸€ç§**æ­£å‘ç­›é€‰æ€ç»´**çš„é¢„æµ‹æ–¹æ³•ï¼Œä¸åŒäºä¼ ç»Ÿçš„"æ’é™¤æ³•"ï¼š

- **ä¼ ç»Ÿæ’é™¤æ³•**: ä»å…¨é‡ç»„åˆï¼ˆ324,632ä¸ªï¼‰ä¸­é€æ­¥æ’é™¤ä¸ç¬¦åˆæ¡ä»¶çš„ç»„åˆ
- **æ­£é€‰æ³•**: å…ˆé€šè¿‡æœŸæœ›ç‰¹å¾æ­£å‘é€‰æ‹©ç¬¦åˆçš„ç»„åˆï¼Œå†é€šè¿‡æ’é™¤æ¡ä»¶ç²¾ç»†ç­›é€‰

### ä¸»è¦ç‰¹ç‚¹

1. **6æ­¥æ­£é€‰ç­›é€‰**
   - çƒ­æ¸©å†·æ¯”ï¼ˆHot-Warm-Cold Ratioï¼‰
   - åŒºé—´æ¯”ï¼ˆZone Ratioï¼‰
   - å’Œå€¼èŒƒå›´ï¼ˆSum Rangeï¼‰
   - è·¨åº¦èŒƒå›´ï¼ˆSpan Rangeï¼‰
   - å¥‡å¶æ¯”ï¼ˆOdd-Even Ratioï¼‰
   - ACå€¼ï¼ˆAC Valueï¼‰

2. **5æ­¥æ’é™¤ç²¾åŒ–**
   - å†å²å’Œå€¼æ’é™¤
   - å†å²è·¨åº¦æ’é™¤
   - å†å²çƒ­æ¸©å†·æ¯”æ’é™¤
   - å†å²åŒºé—´æ¯”æ’é™¤
   - ç›¸å…‹å¯¹æ’é™¤
   - åŒç°æ¯”æ’é™¤

3. **çƒ­æ¸©å†·ä¼˜åŒ–è¡¨**
   - é¢„è®¡ç®—çš„çƒ­æ¸©å†·æ¯”æ•°æ®
   - æ€§èƒ½æå‡1000å€ï¼ˆ5-10ms vs 5-10ç§’ï¼‰
   - æ”¯æŒè‡ªåŠ¨æ£€æŸ¥å’Œç”Ÿæˆ

4. **å‘½ä¸­åˆ†æ**
   - è‡ªåŠ¨è®¡ç®—å†å²å‘½ä¸­æƒ…å†µ
   - æ”¯æŒ9ä¸ªå¥–çº§çš„ç»Ÿè®¡
   - å¥–é‡‘é‡‘é¢è®¡ç®—

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ä¸‰å±‚æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±•ç¤ºå±‚ (UI)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  index.html (è¡Œ 2546-3402)                      â”‚   â”‚
â”‚  â”‚  - æœŸå·èŒƒå›´é…ç½®åŒº                                â”‚   â”‚
â”‚  â”‚  - 6æ­¥æ­£é€‰é…ç½®åŒº (857è¡ŒHTML)                    â”‚   â”‚
â”‚  â”‚  - 5æ­¥æ’é™¤é…ç½®åŒº                                 â”‚   â”‚
â”‚  â”‚  - è¾“å‡ºé…ç½®åŒº                                    â”‚   â”‚
â”‚  â”‚  - æ•°æ®è¦†ç›–ç‡æ£€æŸ¥åŒº                              â”‚   â”‚
â”‚  â”‚  - ä»»åŠ¡åˆ›å»ºæŒ‰é’®                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ DOMäº‹ä»¶ / APIè°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å‰ç«¯é€»è¾‘å±‚ (JavaScript)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  dlt-module.js (è¡Œ 15740-16343)                 â”‚   â”‚
â”‚  â”‚  - initHwcPositivePrediction()                  â”‚   â”‚
â”‚  â”‚  - initHwcEventListeners()                      â”‚   â”‚
â”‚  â”‚  - checkHwcDataCoverage()                       â”‚   â”‚
â”‚  â”‚  - generateMissingHwcData()                     â”‚   â”‚
â”‚  â”‚  - createHwcPositiveTask()                      â”‚   â”‚
â”‚  â”‚  - updateHwcPositiveStats()                     â”‚   â”‚
â”‚  â”‚  - selectHwcPreset()                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ HTTPè¯·æ±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åç«¯APIå±‚ (Express)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  server.js (è¡Œ 13639-14500+)                    â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  API 1: POST /api/dlt/check-hwc-coverage        â”‚   â”‚
â”‚  â”‚         æ£€æŸ¥çƒ­æ¸©å†·ä¼˜åŒ–è¡¨æ•°æ®è¦†ç›–ç‡               â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  API 2: POST /api/dlt/generate-missing-hwc      â”‚   â”‚
â”‚  â”‚         ç”Ÿæˆç¼ºå¤±çš„çƒ­æ¸©å†·ä¼˜åŒ–è¡¨æ•°æ®               â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  API 3: POST /api/dlt/positive-selection/       â”‚   â”‚
â”‚  â”‚         get-combo-ids                            â”‚   â”‚
â”‚  â”‚         æ ¹æ®æ­£é€‰æ¡ä»¶è·å–ç»„åˆID                   â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  API 4: POST /api/dlt/positive-prediction/      â”‚   â”‚
â”‚  â”‚         create-task                              â”‚   â”‚
â”‚  â”‚         åˆ›å»ºçƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹ä»»åŠ¡               â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Helper: processHwcPositiveTask()               â”‚   â”‚
â”‚  â”‚          å¼‚æ­¥ä»»åŠ¡å¤„ç†å‡½æ•°                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ MongooseæŸ¥è¯¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ•°æ®åº“å±‚ (MongoDB)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Collection 1: DLT                              â”‚   â”‚
â”‚  â”‚    - å¤§ä¹é€å†å²å¼€å¥–æ•°æ®                          â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: Issue, Red1-5, Blue1-2               â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Collection 2: DLTRedCombinations               â”‚   â”‚
â”‚  â”‚    - çº¢çƒç»„åˆè¡¨ (324,632æ¡)                     â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: combination_id, balls,               â”‚   â”‚
â”‚  â”‚      sum_value, span_value, zone_ratio,         â”‚   â”‚
â”‚  â”‚      odd_even_ratio, ac_value, etc.             â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Collection 3: DLTBlueCombinations              â”‚   â”‚
â”‚  â”‚    - è“çƒç»„åˆè¡¨ (66æ¡)                           â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: combination_id, balls                â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Collection 4:                                  â”‚   â”‚
â”‚  â”‚    DLTRedCombinationsHotWarmColdOptimized       â”‚   â”‚
â”‚  â”‚    - çƒ­æ¸©å†·ä¼˜åŒ–è¡¨                                â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: base_issue, target_issue,            â”‚   â”‚
â”‚  â”‚      hwc_map (Map<çƒ­æ¸©å†·æ¯”, ç»„åˆID[]>)           â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Collection 5: HwcPositivePredictionTask        â”‚   â”‚
â”‚  â”‚    - çƒ­æ¸©å†·æ­£é€‰ä»»åŠ¡è¡¨                            â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: task_id, task_name, status,          â”‚   â”‚
â”‚  â”‚      positive_selection, exclusion_conditions   â”‚   â”‚
â”‚  â”‚                                                  â”‚   â”‚
â”‚  â”‚  Collection 6: HwcPositivePredictionTaskResult  â”‚   â”‚
â”‚  â”‚    - çƒ­æ¸©å†·æ­£é€‰ä»»åŠ¡ç»“æœè¡¨                        â”‚   â”‚
â”‚  â”‚    - å­—æ®µ: task_id, period, red_combinations,   â”‚   â”‚
â”‚  â”‚      blue_combinations, exclusion_summary,      â”‚   â”‚
â”‚  â”‚      hit_analysis                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–‡ä»¶ä½ç½®æ¸…å•

| ç»„ä»¶ | æ–‡ä»¶è·¯å¾„ | è¡Œå·èŒƒå›´ | ä»£ç é‡ |
|------|---------|---------|-------|
| å‰ç«¯UI | `src/renderer/index.html` | 2546-3402 | 857è¡Œ |
| å‰ç«¯é€»è¾‘ | `src/renderer/dlt-module.js` | 15740-16343 | 603è¡Œ |
| åç«¯API | `src/server/server.js` | 13639-14500+ | 860+è¡Œ |
| Schema | `src/server/server.js` | 1014-1197 | 183è¡Œ |

**æ€»è®¡**: çº¦ 2,503 è¡Œä»£ç 

---

## ğŸ”„ å®Œæ•´é¢„æµ‹æµç¨‹

### æµç¨‹æ¦‚è§ˆå›¾

```
ç”¨æˆ·æ“ä½œå¼€å§‹
    â†“
[æ­¥éª¤1] é…ç½®æœŸå·èŒƒå›´
    â”œâ”€ å…¨éƒ¨å†å²æœŸå·
    â”œâ”€ æœ€è¿‘NæœŸ (é»˜è®¤100æœŸ)
    â””â”€ è‡ªå®šä¹‰èŒƒå›´ (25100-25120)
    â†“
[æ­¥éª¤2] æ£€æŸ¥çƒ­æ¸©å†·ä¼˜åŒ–è¡¨æ•°æ®è¦†ç›–ç‡
    â”œâ”€ è¦†ç›–ç‡ â‰¥ 95% â†’ ç»§ç»­
    â””â”€ è¦†ç›–ç‡ < 95% â†’ ç”Ÿæˆç¼ºå¤±æ•°æ®
    â†“
[æ­¥éª¤3] é…ç½®6æ­¥æ­£é€‰æ¡ä»¶
    â”œâ”€ Step 1: é€‰æ‹©çƒ­æ¸©å†·æ¯” (å¦‚: 3:2:0, 2:2:1)
    â”œâ”€ Step 2: é€‰æ‹©åŒºé—´æ¯” (å¦‚: 2:2:1, 2:1:2)
    â”œâ”€ Step 3: é…ç½®å’Œå€¼èŒƒå›´ (å¦‚: 60-90, 91-120)
    â”œâ”€ Step 4: é…ç½®è·¨åº¦èŒƒå›´ (å¦‚: 15-25, 26-30)
    â”œâ”€ Step 5: é€‰æ‹©å¥‡å¶æ¯” (å¦‚: 2:3, 3:2)
    â””â”€ Step 6: é€‰æ‹©ACå€¼ (å¦‚: 6, 7, 8)
    â†“
[æ­¥éª¤4] é…ç½®5æ­¥æ’é™¤æ¡ä»¶ (å¯é€‰)
    â”œâ”€ å†å²å’Œå€¼æ’é™¤ (æœ€è¿‘NæœŸ)
    â”œâ”€ å†å²è·¨åº¦æ’é™¤ (æœ€è¿‘NæœŸ)
    â”œâ”€ å†å²çƒ­æ¸©å†·æ¯”æ’é™¤ (æœ€è¿‘NæœŸ)
    â”œâ”€ å†å²åŒºé—´æ¯”æ’é™¤ (æœ€è¿‘NæœŸ)
    â”œâ”€ ç›¸å…‹å¯¹æ’é™¤ (Topç›¸å…‹å¯¹, é˜ˆå€¼)
    â””â”€ åŒç°æ¯”æ’é™¤ (é˜ˆå€¼%, ç»Ÿè®¡æœŸæ•°)
    â†“
[æ­¥éª¤5] é…ç½®è¾“å‡ºé€‰é¡¹
    â”œâ”€ é…å¯¹æ¨¡å¼ (é»˜è®¤/æ™®é€šæ— é™åˆ¶/çœŸæ­£æ— é™åˆ¶)
    â”œâ”€ æ‰¹å¤„ç†å¤§å° (é»˜è®¤50,000)
    â”œâ”€ å¯ç”¨å‘½ä¸­åˆ†æ (å·²å¼€å¥–æœŸ)
    â”œâ”€ è‡ªåŠ¨å¯¼å‡ºExcel
    â””â”€ å¯¼å‡ºé¢„è§ˆæ¨¡å¼
    â†“
[æ­¥éª¤6] åˆ›å»ºä»»åŠ¡
    â”œâ”€ éªŒè¯é…ç½®
    â”œâ”€ ç”Ÿæˆå”¯ä¸€ä»»åŠ¡ID: hwc_pos_timestamp_random
    â”œâ”€ ä¿å­˜ä»»åŠ¡åˆ°æ•°æ®åº“
    â””â”€ è§¦å‘å¼‚æ­¥å¤„ç†: processHwcPositiveTask()
    â†“
========== åå°å¼‚æ­¥å¤„ç†å¼€å§‹ ==========
    â†“
[é˜¶æ®µ1] è§£ææœŸå·èŒƒå›´
    â”œâ”€ è°ƒç”¨: resolveIssueRangeInternal()
    â”œâ”€ è¿”å›: æœŸå·æ•°ç»„ [25100, 25101, ..., 25120]
    â””â”€ ç”ŸæˆæœŸå·å¯¹: [(25100â†’25101), (25101â†’25102), ...]
    â†“
[é˜¶æ®µ2] é€æœŸå¤„ç† (å¾ªç¯)
    â†“
    å¯¹äºæ¯ä¸ªæœŸå·å¯¹ (base_issue â†’ target_issue):
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  [2.1] 6æ­¥æ­£é€‰ç­›é€‰                        â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚  è¾“å…¥: 324,632 ä¸ªçº¢çƒç»„åˆ (å…¨é›†)          â”‚
    â”‚                                          â”‚
    â”‚  Step 1: çƒ­æ¸©å†·æ¯”ç­›é€‰                     â”‚
    â”‚    - ä» DLTRedCombinationsHotWarmColdOptimized â”‚
    â”‚      æŸ¥è¯¢ hwc_map                         â”‚
    â”‚    - æ ¹æ®é€‰ä¸­çš„çƒ­æ¸©å†·æ¯”è·å–ç»„åˆIDé›†åˆ      â”‚
    â”‚    - æ—¶é—´å¤æ‚åº¦: O(1)                     â”‚
    â”‚    - ç»“æœ: çº¦ 15,000 - 200,000 ä¸ªç»„åˆ     â”‚
    â”‚         â†“                                â”‚
    â”‚  Step 2: åŒºé—´æ¯”ç­›é€‰                       â”‚
    â”‚    - ä» DLTRedCombinations æŸ¥è¯¢          â”‚
    â”‚      zone_ratio å­—æ®µ                     â”‚
    â”‚    - ç­›é€‰åŒ¹é…çš„ç»„åˆ                       â”‚
    â”‚    - ç»“æœ: çº¦ 10,000 - 150,000 ä¸ªç»„åˆ     â”‚
    â”‚         â†“                                â”‚
    â”‚  Step 3: å’Œå€¼èŒƒå›´ç­›é€‰                     â”‚
    â”‚    - ç­›é€‰ sum_value åœ¨èŒƒå›´å†…çš„ç»„åˆ        â”‚
    â”‚    - ç»“æœ: çº¦ 8,000 - 100,000 ä¸ªç»„åˆ      â”‚
    â”‚         â†“                                â”‚
    â”‚  Step 4: è·¨åº¦èŒƒå›´ç­›é€‰                     â”‚
    â”‚    - ç­›é€‰ span_value åœ¨èŒƒå›´å†…çš„ç»„åˆ       â”‚
    â”‚    - ç»“æœ: çº¦ 6,000 - 80,000 ä¸ªç»„åˆ       â”‚
    â”‚         â†“                                â”‚
    â”‚  Step 5: å¥‡å¶æ¯”ç­›é€‰                       â”‚
    â”‚    - ç­›é€‰ odd_even_ratio åŒ¹é…çš„ç»„åˆ       â”‚
    â”‚    - ç»“æœ: çº¦ 5,000 - 60,000 ä¸ªç»„åˆ       â”‚
    â”‚         â†“                                â”‚
    â”‚  Step 6: ACå€¼ç­›é€‰                         â”‚
    â”‚    - ç­›é€‰ ac_value åŒ¹é…çš„ç»„åˆ             â”‚
    â”‚    - ç»“æœ: çº¦ 3,000 - 20,000 ä¸ªç»„åˆ       â”‚
    â”‚         â†“                                â”‚
    â”‚  æ­£é€‰ç­›é€‰åç»„åˆIDé›†åˆ: red_combo_ids      â”‚
    â”‚  å‹ç¼©ç‡: 93.8% - 99.1%                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  [2.2] 5æ­¥æ’é™¤æ¡ä»¶ç­›é€‰ (å¯é€‰)             â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚  è¾“å…¥: æ­£é€‰åçš„çº¢çƒç»„åˆIDé›†åˆ             â”‚
    â”‚                                          â”‚
    â”‚  Exclude 1: å†å²å’Œå€¼æ’é™¤                  â”‚
    â”‚    - è·å–æœ€è¿‘NæœŸçš„å’Œå€¼é›†åˆ                â”‚
    â”‚    - æ’é™¤å’Œå€¼åŒ¹é…çš„ç»„åˆ                   â”‚
    â”‚    - æ’é™¤é‡: çº¦ 5-15%                     â”‚
    â”‚         â†“                                â”‚
    â”‚  Exclude 2: å†å²è·¨åº¦æ’é™¤                  â”‚
    â”‚    - è·å–æœ€è¿‘NæœŸçš„è·¨åº¦é›†åˆ                â”‚
    â”‚    - æ’é™¤è·¨åº¦åŒ¹é…çš„ç»„åˆ                   â”‚
    â”‚    - æ’é™¤é‡: çº¦ 5-15%                     â”‚
    â”‚         â†“                                â”‚
    â”‚  Exclude 3: å†å²çƒ­æ¸©å†·æ¯”æ’é™¤              â”‚
    â”‚    - è·å–æœ€è¿‘NæœŸçš„çƒ­æ¸©å†·æ¯”é›†åˆ            â”‚
    â”‚    - æ’é™¤çƒ­æ¸©å†·æ¯”åŒ¹é…çš„ç»„åˆ               â”‚
    â”‚    - æ’é™¤é‡: çº¦ 5-10%                     â”‚
    â”‚         â†“                                â”‚
    â”‚  Exclude 4: å†å²åŒºé—´æ¯”æ’é™¤                â”‚
    â”‚    - è·å–æœ€è¿‘NæœŸçš„åŒºé—´æ¯”é›†åˆ              â”‚
    â”‚    - æ’é™¤åŒºé—´æ¯”åŒ¹é…çš„ç»„åˆ                 â”‚
    â”‚    - æ’é™¤é‡: çº¦ 5-10%                     â”‚
    â”‚         â†“                                â”‚
    â”‚  Exclude 5: ç›¸å…‹å¯¹æ’é™¤                    â”‚
    â”‚    - è®¡ç®—çƒå·å¯¹çš„åŒç°æ¬¡æ•° (æœ€è¿‘50æœŸ)       â”‚
    â”‚    - æ‰¾å‡ºä»æœªåŒç°æˆ–åŒç°æ¬¡æ•°â‰¤é˜ˆå€¼çš„çƒå·å¯¹   â”‚
    â”‚    - æ’é™¤åŒ…å«ç›¸å…‹å¯¹çš„ç»„åˆ                 â”‚
    â”‚    - æ’é™¤é‡: çº¦ 10-30%                    â”‚
    â”‚         â†“                                â”‚
    â”‚  Exclude 6: åŒç°æ¯”æ’é™¤                    â”‚
    â”‚    - ç»Ÿè®¡ combo_2/3/4 çš„åŒç°é¢‘ç‡          â”‚
    â”‚    - æ’é™¤åŒç°æ¯” < é˜ˆå€¼çš„ç»„åˆ              â”‚
    â”‚    - æ’é™¤é‡: çº¦ 10-40%                    â”‚
    â”‚         â†“                                â”‚
    â”‚  æœ€ç»ˆä¿ç•™ç»„åˆIDé›†åˆ: final_red_combo_ids  â”‚
    â”‚  ç»¼åˆä¿ç•™ç‡: çº¦ 30-70%                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  [2.3] è“çƒç»„åˆå¤„ç†                       â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚  æ ¹æ®é…å¯¹æ¨¡å¼é€‰æ‹©è“çƒ:                    â”‚
    â”‚                                          â”‚
    â”‚  - defaultæ¨¡å¼: è“çƒ1-12å…¨é€‰ (12ä¸ª)       â”‚
    â”‚  - unlimitedæ¨¡å¼: ç”¨æˆ·æŒ‡å®šè“çƒç»„åˆ        â”‚
    â”‚  - truly-unlimitedæ¨¡å¼: å…¨éƒ¨66ä¸ªè“çƒç»„åˆ  â”‚
    â”‚         â†“                                â”‚
    â”‚  blue_combo_ids                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  [2.4] å‘½ä¸­åˆ†æ (å·²å¼€å¥–æœŸ)                â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚  å¦‚æœ target_issue å·²å¼€å¥–:                â”‚
    â”‚                                          â”‚
    â”‚  1. è·å–å¼€å¥–å·ç                           â”‚
    â”‚     - æŸ¥è¯¢ DLT.findOne({ Issue: target_issue }) â”‚
    â”‚     - æå–: red_balls, blue_balls        â”‚
    â”‚                                          â”‚
    â”‚  2. éå†ä¿ç•™çš„ç»„åˆ                        â”‚
    â”‚     For each (red_combo, blue_combo):    â”‚
    â”‚       - è®¡ç®—çº¢çƒå‘½ä¸­æ•°: red_hit           â”‚
    â”‚       - è®¡ç®—è“çƒå‘½ä¸­æ•°: blue_hit           â”‚
    â”‚       - åˆ¤æ–­å¥–çº§: judgePrize(red_hit, blue_hit) â”‚
    â”‚       - ç»Ÿè®¡å„å¥–çº§æ¬¡æ•°                    â”‚
    â”‚                                          â”‚
    â”‚  3. æ±‡æ€»å‘½ä¸­ç»Ÿè®¡                          â”‚
    â”‚     - total_combinations: æ€»ç»„åˆæ•°        â”‚
    â”‚     - hit_combinations: ä¸­å¥–ç»„åˆæ•°        â”‚
    â”‚     - hit_rate: ä¸­å¥–ç‡ (%)                â”‚
    â”‚     - prize_distribution: {               â”‚
    â”‚         "ä¸€ç­‰å¥–": æ¬¡æ•°,                    â”‚
    â”‚         "äºŒç­‰å¥–": æ¬¡æ•°,                    â”‚
    â”‚         ...                              â”‚
    â”‚       }                                  â”‚
    â”‚     - total_prize: æ€»å¥–é‡‘é‡‘é¢             â”‚
    â”‚     - max_red_hit: æœ€å¤§çº¢çƒå‘½ä¸­æ•°         â”‚
    â”‚     - max_blue_hit: æœ€å¤§è“çƒå‘½ä¸­æ•°        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  [2.5] ä¿å­˜æœŸå·ç»“æœ                       â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚  HwcPositivePredictionTaskResult.create({ â”‚
    â”‚    task_id: ä»»åŠ¡ID,                       â”‚
    â”‚    period: target_issue,                 â”‚
    â”‚    base_period: base_issue,              â”‚
    â”‚    red_combinations: final_red_combo_ids,â”‚
    â”‚    blue_combinations: blue_combo_ids,    â”‚
    â”‚    combination_count: æ€»ç»„åˆæ•°,           â”‚
    â”‚    is_predicted: æ˜¯å¦æ¨ç®—æœŸ,              â”‚
    â”‚    winning_numbers: å¼€å¥–å·ç  (å¦‚æœ‰),      â”‚
    â”‚    exclusion_summary: {                  â”‚
    â”‚      positive_selection_count: æ­£é€‰åæ•°é‡, â”‚
    â”‚      sum_exclude_count: å’Œå€¼æ’é™¤æ•°,       â”‚
    â”‚      span_exclude_count: è·¨åº¦æ’é™¤æ•°,      â”‚
    â”‚      hwc_exclude_count: çƒ­æ¸©å†·æ¯”æ’é™¤æ•°,   â”‚
    â”‚      zone_exclude_count: åŒºé—´æ¯”æ’é™¤æ•°,    â”‚
    â”‚      conflict_exclude_count: ç›¸å…‹å¯¹æ’é™¤æ•°, â”‚
    â”‚      cooccurrence_exclude_count: åŒç°æ¯”æ’é™¤æ•°, â”‚
    â”‚      final_count: æœ€ç»ˆä¿ç•™æ•°              â”‚
    â”‚    },                                    â”‚
    â”‚    hit_analysis: å‘½ä¸­åˆ†ææ•°æ® (å¦‚æœ‰)      â”‚
    â”‚  })                                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
[é˜¶æ®µ3] æ›´æ–°ä»»åŠ¡çŠ¶æ€
    â”œâ”€ å¾ªç¯è¿›åº¦: current_period / total_periods
    â”œâ”€ ä»»åŠ¡çŠ¶æ€: processing
    â””â”€ ä¿å­˜åˆ°æ•°æ®åº“
    â†“
[é˜¶æ®µ4] ä»»åŠ¡å®Œæˆ
    â”œâ”€ æ›´æ–°ä»»åŠ¡çŠ¶æ€: completed
    â”œâ”€ è®°å½•å®Œæˆæ—¶é—´: completed_at
    â”œâ”€ è®¡ç®—æ€»ç”¨æ—¶: duration
    â””â”€ å¦‚æœå¯ç”¨è‡ªåŠ¨å¯¼å‡º â†’ è§¦å‘Excelå¯¼å‡º
    â†“
========== åå°å¼‚æ­¥å¤„ç†ç»“æŸ ==========
    â†“
[æ­¥éª¤7] æŸ¥çœ‹ä»»åŠ¡ç»“æœ
    â”œâ”€ ä»»åŠ¡åˆ—è¡¨: æ˜¾ç¤ºæ‰€æœ‰çƒ­æ¸©å†·æ­£é€‰ä»»åŠ¡
    â”œâ”€ ä»»åŠ¡è¯¦æƒ…: æŸ¥çœ‹é…ç½®å’ŒæœŸå·ç»“æœ
    â”œâ”€ æœŸå·ç»“æœ: æ¯æœŸçš„ä¿ç•™ç»„åˆæ•°å’Œå‘½ä¸­ç»Ÿè®¡
    â”œâ”€ æ’é™¤æ˜ç»†: å„æ’é™¤æ¡ä»¶çš„æ’é™¤æ•°é‡
    â””â”€ å¯¼å‡ºExcel: å•æœŸæˆ–å…¨é‡å¯¼å‡º
    â†“
ç”¨æˆ·æ“ä½œç»“æŸ
```

---

## ğŸ“Š æ•°æ®æµè½¬è¯¦è§£

### 1. è¾“å…¥æ•°æ®

#### 1.1 æœŸå·èŒƒå›´é…ç½®
```javascript
{
  rangeType: "recent",        // "all" | "recent" | "custom"
  recentCount: 100,            // rangeType="recent" æ—¶
  startIssue: "25100",         // rangeType="custom" æ—¶
  endIssue: "25120"            // rangeType="custom" æ—¶
}
```

**è§£æç»“æœ**:
```javascript
// å‡è®¾æœ€æ–°æœŸå·æ˜¯ 25120
issue_range = [
  "25020", "25021", ..., "25120",  // 100æœŸå·²å¼€å¥–
  "25121"                           // æ¨ç®—çš„ä¸‹ä¸€æœŸ
]

// æœŸå·å¯¹ (ç›¸é‚»é…å¯¹)
issue_pairs = [
  { base_issue: "25020", target_issue: "25021" },
  { base_issue: "25021", target_issue: "25022" },
  ...
  { base_issue: "25120", target_issue: "25121" }  // æ¨ç®—æœŸ
]
```

#### 1.2 æ­£é€‰æ¡ä»¶é…ç½®
```javascript
positiveSelection = {
  // Step 1: çƒ­æ¸©å†·æ¯” (21ç§å¯é€‰)
  hwcRatios: ["3:2:0", "2:2:1", "2:1:2", "1:2:2"],

  // Step 2: åŒºé—´æ¯” (21ç§å¯é€‰)
  zoneRatios: ["2:2:1", "2:1:2", "1:2:2"],

  // Step 3: å’Œå€¼èŒƒå›´ (3ä¸ªå¯é€‰èŒƒå›´)
  sumRanges: [
    { min: 60, max: 90, enabled: true },
    { min: 91, max: 120, enabled: true },
    { min: 121, max: 150, enabled: false }
  ],

  // Step 4: è·¨åº¦èŒƒå›´ (3ä¸ªå¯é€‰èŒƒå›´)
  spanRanges: [
    { min: 15, max: 25, enabled: true },
    { min: 26, max: 30, enabled: true },
    { min: 31, max: 34, enabled: false }
  ],

  // Step 5: å¥‡å¶æ¯” (6ç§å¯é€‰)
  oddEvenRatios: ["2:3", "3:2"],

  // Step 6: ACå€¼ (11ç§å¯é€‰: 0-10)
  acValues: [6, 7, 8]
}
```

#### 1.3 æ’é™¤æ¡ä»¶é…ç½®
```javascript
exclusionConditions = {
  // å†å²å’Œå€¼æ’é™¤
  historicalSum: {
    enabled: true,
    period: 10           // æ’é™¤æœ€è¿‘10æœŸå‡ºç°è¿‡çš„å’Œå€¼
  },

  // å†å²è·¨åº¦æ’é™¤
  historicalSpan: {
    enabled: true,
    period: 10           // æ’é™¤æœ€è¿‘10æœŸå‡ºç°è¿‡çš„è·¨åº¦
  },

  // å†å²çƒ­æ¸©å†·æ¯”æ’é™¤
  historicalHwc: {
    enabled: true,
    period: 10           // æ’é™¤æœ€è¿‘10æœŸå‡ºç°è¿‡çš„çƒ­æ¸©å†·æ¯”
  },

  // å†å²åŒºé—´æ¯”æ’é™¤
  historicalZone: {
    enabled: true,
    period: 10           // æ’é™¤æœ€è¿‘10æœŸå‡ºç°è¿‡çš„åŒºé—´æ¯”
  },

  // ç›¸å…‹å¯¹æ’é™¤
  conflictPairs: {
    enabled: true,
    globalTopN: 20,      // å…¨å±€Topç›¸å…‹å¯¹æ•°é‡
    perNumberTopN: 3,    // æ¯ä¸ªå·ç çš„Topç›¸å…‹å¯¹æ•°é‡
    threshold: "strict"  // "strict"(0æ¬¡) | "loose"(â‰¤1æ¬¡) | "very-loose"(â‰¤2æ¬¡)
  },

  // åŒç°æ¯”æ’é™¤
  coOccurrence: {
    enabled: true,
    type: "combo_2",     // "combo_2" | "combo_3" | "combo_4"
    threshold: 10,       // åŒç°æ¯”é˜ˆå€¼ (%)
    period: 30           // ç»Ÿè®¡æœŸæ•°
  }
}
```

#### 1.4 è¾“å‡ºé…ç½®
```javascript
outputConfig = {
  pairingMode: "default",              // "default" | "unlimited" | "truly-unlimited"
  batchSize: 50000,                    // æ‰¹å¤„ç†å¤§å°
  enableHitAnalysis: true,             // å¯ç”¨å‘½ä¸­åˆ†æ
  autoExport: false,                   // è‡ªåŠ¨å¯¼å‡ºExcel
  previewMode: "comprehensive",        // å¯¼å‡ºé¢„è§ˆæ¨¡å¼
  includeExclusionDetails: false       // åŒ…å«æ’é™¤æ˜ç»†
}
```

### 2. ä¸­é—´æ•°æ®

#### 2.1 çƒ­æ¸©å†·ä¼˜åŒ–è¡¨æ•°æ®ç»“æ„
```javascript
// Collection: DLTRedCombinationsHotWarmColdOptimized
{
  base_issue: "25120",
  target_issue: "25121",
  hwc_map: Map {
    "5:0:0" => [1, 5, 23, 67, ...],        // ç»„åˆIDæ•°ç»„
    "4:1:0" => [12, 34, 56, 89, ...],
    "3:2:0" => [45, 78, 90, 123, ...],
    "3:1:1" => [234, 345, 456, ...],
    "2:2:1" => [567, 678, 789, ...],
    ...
    "0:0:5" => [320000, 320001, ...]       // 21ç§çƒ­æ¸©å†·æ¯”
  },
  created_at: ISODate("2025-10-28T10:00:00Z")
}
```

**çƒ­æ¸©å†·åˆ†ç±»è§„åˆ™**:
- **çƒ­çƒ (Hot)**: é—æ¼å€¼ â‰¤ 4æœŸ
- **æ¸©çƒ (Warm)**: é—æ¼å€¼ 5-9æœŸ
- **å†·çƒ (Cold)**: é—æ¼å€¼ â‰¥ 10æœŸ

**ç¤ºä¾‹**:
```
æœŸå· 25120 çš„é—æ¼å€¼:
çƒå·:  01  02  03  04  05  06  07  08  09  10
é—æ¼:  3   1   8   15  5   2   11  6   18  4
åˆ†ç±»: çƒ­  çƒ­  æ¸©  å†·  æ¸©  çƒ­  å†·  æ¸©  å†·  çƒ­

ç»„åˆ [01, 02, 06, 10, 15] â†’ 4ä¸ªçƒ­çƒ, 0ä¸ªæ¸©çƒ, 1ä¸ªå†·çƒ â†’ çƒ­æ¸©å†·æ¯”: 4:0:1
```

#### 2.2 çº¢çƒç»„åˆæ•°æ®ç»“æ„
```javascript
// Collection: DLTRedCombinations
{
  combination_id: 12345,
  balls: [3, 7, 15, 22, 31],              // çº¢çƒå·ç  (å‡åº)
  sum_value: 78,                          // å’Œå€¼
  span_value: 28,                         // è·¨åº¦ (max - min)
  zone_ratio: "2:2:1",                    // åŒºé—´æ¯”
  odd_even_ratio: "3:2",                  // å¥‡å¶æ¯”
  ac_value: 7,                            // ACå€¼
  has_consecutive: true,                  // æ˜¯å¦æœ‰è¿å·
  consecutive_count: 2,                   // è¿å·ä¸ªæ•°
  combo_2: [[3,7], [3,15], [3,22], ...],  // 2çƒç»„åˆ
  combo_3: [[3,7,15], [3,7,22], ...],     // 3çƒç»„åˆ
  combo_4: [[3,7,15,22], [3,7,15,31], ...] // 4çƒç»„åˆ
}
```

#### 2.3 æœŸå·ç»“æœæ•°æ®ç»“æ„
```javascript
// Collection: HwcPositivePredictionTaskResult
{
  task_id: "hwc_pos_1730103845123_abc123",
  period: 25121,
  base_period: 25120,
  red_combinations: [12345, 12346, 12347, ...],  // ä¿ç•™çš„çº¢çƒç»„åˆID
  blue_combinations: [1, 2, 3, ...],              // ä¿ç•™çš„è“çƒç»„åˆID
  combination_count: 18500,                       // æ€»ç»„åˆæ•°
  is_predicted: true,                             // æ˜¯å¦æ¨ç®—æœŸ
  winning_numbers: {                              // å¼€å¥–å·ç  (å·²å¼€å¥–æœŸ)
    red: [3, 7, 15, 22, 31],
    blue: [5, 9]
  },
  exclusion_summary: {                            // æ’é™¤ç»Ÿè®¡
    positive_selection_count: 25000,
    sum_exclude_count: 1200,
    span_exclude_count: 800,
    hwc_exclude_count: 600,
    zone_exclude_count: 500,
    conflict_exclude_count: 2400,
    cooccurrence_exclude_count: 1000,
    final_count: 18500
  },
  hit_analysis: {                                 // å‘½ä¸­åˆ†æ (å·²å¼€å¥–æœŸ)
    total_combinations: 18500,
    hit_combinations: 3200,
    hit_rate: 17.30,
    prize_distribution: {
      "ä¸€ç­‰å¥–": 0,
      "äºŒç­‰å¥–": 0,
      "ä¸‰ç­‰å¥–": 0,
      "å››ç­‰å¥–": 2,
      "äº”ç­‰å¥–": 15,
      "å…­ç­‰å¥–": 45,
      "ä¸ƒç­‰å¥–": 120,
      "å…«ç­‰å¥–": 800,
      "ä¹ç­‰å¥–": 2218
    },
    total_prize: 126500,
    max_red_hit: 4,
    max_blue_hit: 2
  },
  created_at: ISODate("2025-10-28T10:15:00Z")
}
```

### 3. è¾“å‡ºæ•°æ®

#### 3.1 ä»»åŠ¡çŠ¶æ€
```javascript
{
  task_id: "hwc_pos_1730103845123_abc123",
  task_name: "çƒ­æ¸©å†·æ­£é€‰_2025-10-28",
  task_type: "hwc_positive_selection",
  status: "completed",                    // "pending" | "processing" | "completed" | "failed"
  progress: 100,                          // è¿›åº¦ç™¾åˆ†æ¯”
  total_periods: 101,                     // æ€»æœŸæ•°
  processed_periods: 101,                 // å·²å¤„ç†æœŸæ•°
  created_at: ISODate("2025-10-28T10:00:00Z"),
  started_at: ISODate("2025-10-28T10:00:05Z"),
  completed_at: ISODate("2025-10-28T10:25:00Z"),
  duration: 1495                          // ç”¨æ—¶ (ç§’)
}
```

#### 3.2 Excelå¯¼å‡ºç»“æ„
```
çƒ­æ¸©å†·æ­£é€‰_ä»»åŠ¡å_25121æœŸ_2025-10-28.xlsx
â”œâ”€ Sheet 1: é¢„æµ‹ç»„åˆè¡¨
â”‚  â”œâ”€ åºå·
â”‚  â”œâ”€ çº¢çƒç»„åˆ
â”‚  â”œâ”€ è“çƒç»„åˆ
â”‚  â”œâ”€ å’Œå€¼
â”‚  â”œâ”€ è·¨åº¦
â”‚  â”œâ”€ åŒºé—´æ¯”
â”‚  â”œâ”€ å¥‡å¶æ¯”
â”‚  â”œâ”€ çƒ­æ¸©å†·æ¯”
â”‚  â”œâ”€ ACå€¼
â”‚  â”œâ”€ è¿å·æƒ…å†µ
â”‚  â”œâ”€ çº¢çƒå‘½ä¸­ (å·²å¼€å¥–æœŸ)
â”‚  â”œâ”€ è“çƒå‘½ä¸­ (å·²å¼€å¥–æœŸ)
â”‚  â””â”€ ä¸­å¥–ç­‰çº§ (å·²å¼€å¥–æœŸ)
â”‚
â”œâ”€ Sheet 2: çº¢çƒæ’é™¤è¯¦æƒ… (å¾…å®ç°)
â”‚  â”œâ”€ çº¢çƒç»„åˆ
â”‚  â”œâ”€ å’Œå€¼
â”‚  â”œâ”€ è·¨åº¦
â”‚  â”œâ”€ åŒºé—´æ¯”
â”‚  â”œâ”€ å¥‡å¶æ¯”
â”‚  â”œâ”€ çƒ­æ¸©å†·æ¯”
â”‚  â”œâ”€ ACå€¼
â”‚  â”œâ”€ è¿å·æƒ…å†µ
â”‚  â””â”€ æ’é™¤åŸå› 
â”‚
â””â”€ Sheet 3: æ’é™¤ç»Ÿè®¡è¡¨
   â”œâ”€ æ’é™¤æ¡ä»¶
   â”œâ”€ æ’é™¤ç»„åˆæ•°
   â””â”€ æ’é™¤ç™¾åˆ†æ¯”
```

---

## ğŸ¯ 6æ­¥æ­£é€‰ç®—æ³•

### Step 1: çƒ­æ¸©å†·æ¯”ç­›é€‰

**åŸç†**: åŸºäºé—æ¼å€¼åˆ†æï¼Œå°†çº¢çƒåˆ†ä¸ºçƒ­ã€æ¸©ã€å†·ä¸‰ç±»ï¼Œé€‰æ‹©æœŸæœ›çš„çƒ­æ¸©å†·æ¯”ä¾‹ç»„åˆã€‚

**æ•°æ®æº**: `DLTRedCombinationsHotWarmColdOptimized.hwc_map`

**ç®—æ³•**:
```javascript
// ä¼ªä»£ç 
function step1_hwcRatioFilter(baseIssue, targetIssue, selectedRatios) {
  // 1. æŸ¥è¯¢çƒ­æ¸©å†·ä¼˜åŒ–è¡¨
  const hwcRecord = await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: baseIssue,
    target_issue: targetIssue
  });

  // 2. ä»hwc_mapä¸­è·å–æ‰€æœ‰é€‰ä¸­æ¯”ä¾‹çš„ç»„åˆID
  let candidateIds = new Set();
  for (const ratio of selectedRatios) {
    const ids = hwcRecord.hwc_map.get(ratio) || [];
    ids.forEach(id => candidateIds.add(id));
  }

  // 3. è¿”å›å€™é€‰IDé›†åˆ
  return candidateIds;  // Set<number>
}
```

**æ€§èƒ½**: O(1) MapæŸ¥æ‰¾ + O(N) é›†åˆåˆå¹¶ï¼Œçº¦ 5-10ms

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
selectedRatios = ["3:2:0", "2:2:1", "2:1:2"]

// è¾“å‡º
candidateIds = Set {
  1, 5, 12, 23, 45, 67, 89, 123, 234, 345, ...  // çº¦ 50,000 ä¸ªç»„åˆID
}
```

---

### Step 2: åŒºé—´æ¯”ç­›é€‰

**åŸç†**: å°†35ä¸ªçº¢çƒåˆ’åˆ†ä¸º3ä¸ªåŒºé—´ï¼Œé€‰æ‹©æœŸæœ›çš„åŒºé—´åˆ†å¸ƒæ¯”ä¾‹ã€‚

**åŒºé—´åˆ’åˆ†**:
- Zone 1: çƒå· 1-12
- Zone 2: çƒå· 13-24
- Zone 3: çƒå· 25-35

**æ•°æ®æº**: `DLTRedCombinations.zone_ratio`

**ç®—æ³•**:
```javascript
function step2_zoneRatioFilter(candidateIds, selectedZoneRatios) {
  // 1. æŸ¥è¯¢å€™é€‰ç»„åˆçš„åŒºé—´æ¯”æ•°æ®
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) },
    zone_ratio: { $in: selectedZoneRatios }
  }).select('combination_id');

  // 2. æå–åŒ¹é…çš„ç»„åˆID
  const filteredIds = new Set(
    combinations.map(c => c.combination_id)
  );

  return filteredIds;
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
selectedZoneRatios = ["2:2:1", "2:1:2", "1:2:2"]

// ç»„åˆ [3, 7, 15, 22, 31] çš„åŒºé—´åˆ†å¸ƒ
Zone 1: [3, 7]           â†’ 2ä¸ª
Zone 2: [15, 22]         â†’ 2ä¸ª
Zone 3: [31]             â†’ 1ä¸ª
åŒºé—´æ¯”: "2:2:1" âœ… åŒ¹é…

// è¾“å‡º
filteredIds = Set { 12, 45, 123, 234, ... }  // çº¦ 30,000 ä¸ªç»„åˆID
```

---

### Step 3: å’Œå€¼èŒƒå›´ç­›é€‰

**åŸç†**: 5ä¸ªçº¢çƒä¹‹å’Œè½åœ¨æœŸæœ›çš„æ•°å€¼èŒƒå›´å†…ã€‚

**æ•°æ®æº**: `DLTRedCombinations.sum_value`

**ç®—æ³•**:
```javascript
function step3_sumRangeFilter(candidateIds, sumRanges) {
  // 1. æ„å»ºæŸ¥è¯¢æ¡ä»¶
  const orConditions = sumRanges
    .filter(r => r.enabled)
    .map(r => ({
      sum_value: { $gte: r.min, $lte: r.max }
    }));

  // 2. æŸ¥è¯¢åŒ¹é…çš„ç»„åˆ
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) },
    $or: orConditions
  }).select('combination_id');

  return new Set(combinations.map(c => c.combination_id));
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
sumRanges = [
  { min: 60, max: 90, enabled: true },
  { min: 91, max: 120, enabled: true }
]

// ç»„åˆ [3, 7, 15, 22, 31] çš„å’Œå€¼
sum = 3 + 7 + 15 + 22 + 31 = 78
78 âˆˆ [60, 90] âœ… åŒ¹é…

// è¾“å‡º
filteredIds = Set { 45, 123, 234, ... }  // çº¦ 20,000 ä¸ªç»„åˆID
```

---

### Step 4: è·¨åº¦èŒƒå›´ç­›é€‰

**åŸç†**: æœ€å¤§çƒå· - æœ€å°çƒå·çš„å·®å€¼è½åœ¨æœŸæœ›èŒƒå›´å†…ã€‚

**æ•°æ®æº**: `DLTRedCombinations.span_value`

**ç®—æ³•**:
```javascript
function step4_spanRangeFilter(candidateIds, spanRanges) {
  const orConditions = spanRanges
    .filter(r => r.enabled)
    .map(r => ({
      span_value: { $gte: r.min, $lte: r.max }
    }));

  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) },
    $or: orConditions
  }).select('combination_id');

  return new Set(combinations.map(c => c.combination_id));
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
spanRanges = [
  { min: 15, max: 25, enabled: true },
  { min: 26, max: 30, enabled: true }
]

// ç»„åˆ [3, 7, 15, 22, 31] çš„è·¨åº¦
span = 31 - 3 = 28
28 âˆˆ [26, 30] âœ… åŒ¹é…

// è¾“å‡º
filteredIds = Set { 123, 234, ... }  // çº¦ 15,000 ä¸ªç»„åˆID
```

---

### Step 5: å¥‡å¶æ¯”ç­›é€‰

**åŸç†**: å¥‡æ•°çƒå’Œå¶æ•°çƒçš„æ•°é‡æ¯”ä¾‹ç¬¦åˆæœŸæœ›ã€‚

**æ•°æ®æº**: `DLTRedCombinations.odd_even_ratio`

**ç®—æ³•**:
```javascript
function step5_oddEvenRatioFilter(candidateIds, selectedOddEvenRatios) {
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) },
    odd_even_ratio: { $in: selectedOddEvenRatios }
  }).select('combination_id');

  return new Set(combinations.map(c => c.combination_id));
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
selectedOddEvenRatios = ["2:3", "3:2"]

// ç»„åˆ [3, 7, 15, 22, 31]
å¥‡æ•°: [3, 7, 15, 31]  â†’ 4ä¸ª
å¶æ•°: [22]           â†’ 1ä¸ª
å¥‡å¶æ¯”: "4:1" âŒ ä¸åŒ¹é…

// ç»„åˆ [3, 7, 15, 22, 28]
å¥‡æ•°: [3, 7, 15]     â†’ 3ä¸ª
å¶æ•°: [22, 28]       â†’ 2ä¸ª
å¥‡å¶æ¯”: "3:2" âœ… åŒ¹é…

// è¾“å‡º
filteredIds = Set { 234, ... }  // çº¦ 10,000 ä¸ªç»„åˆID
```

---

### Step 6: ACå€¼ç­›é€‰

**åŸç†**: ACå€¼è¡¡é‡ç»„åˆçš„ç¦»æ•£ç¨‹åº¦ï¼ŒACå€¼è¶Šé«˜ï¼Œç»„åˆè¶Šåˆ†æ•£ã€‚

**ACå€¼å®šä¹‰**: ç»„åˆä¸­ä»»æ„ä¸¤æ•°ä¹‹å·®çš„ç»å¯¹å€¼çš„**ä¸é‡å¤ä¸ªæ•°**

**æ•°æ®æº**: `DLTRedCombinations.ac_value`

**ç®—æ³•**:
```javascript
function step6_acValueFilter(candidateIds, selectedAcValues) {
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) },
    ac_value: { $in: selectedAcValues }
  }).select('combination_id');

  return new Set(combinations.map(c => c.combination_id));
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
selectedAcValues = [6, 7, 8]

// ç»„åˆ [3, 7, 15, 22, 31] çš„ACå€¼è®¡ç®—
å·®å€¼é›†åˆ = {
  |7-3|=4, |15-3|=12, |22-3|=19, |31-3|=28,
  |15-7|=8, |22-7|=15, |31-7|=24,
  |22-15|=7, |31-15|=16,
  |31-22|=9
}
ä¸é‡å¤å·®å€¼ = {4, 7, 8, 9, 12, 15, 16, 19, 24, 28}
ACå€¼ = 10 âŒ ä¸åŒ¹é…

// ç»„åˆ [5, 10, 15, 20, 25] çš„ACå€¼
å·®å€¼é›†åˆ = {5, 10, 15, 20}
ACå€¼ = 4 âŒ ä¸åŒ¹é…

// ç»„åˆ [1, 8, 12, 23, 35] çš„ACå€¼
ACå€¼ = 7 âœ… åŒ¹é…

// è¾“å‡º
filteredIds = Set { 234, 567, ... }  // çº¦ 5,000-8,000 ä¸ªç»„åˆID
```

---

## ğŸš« 5æ­¥æ’é™¤ç®—æ³•

### Exclude 1: å†å²å’Œå€¼æ’é™¤

**åŸç†**: æ’é™¤æœ€è¿‘NæœŸå†…å‡ºç°è¿‡çš„å’Œå€¼ç»„åˆï¼Œé¿å…é‡å¤å†å²å’Œå€¼æ¨¡å¼ã€‚

**ç®—æ³•**:
```javascript
async function exclude1_historicalSum(candidateIds, period) {
  // 1. è·å–æœ€è¿‘NæœŸçš„å¼€å¥–æ•°æ®
  const recentIssues = await DLT.find()
    .sort({ Issue: -1 })
    .limit(period)
    .lean();

  // 2. è®¡ç®—æ¯æœŸçš„å’Œå€¼
  const historicalSums = new Set(
    recentIssues.map(issue => {
      const redBalls = [issue.Red1, issue.Red2, issue.Red3, issue.Red4, issue.Red5];
      return redBalls.reduce((sum, ball) => sum + ball, 0);
    })
  );

  // 3. æŸ¥è¯¢å€™é€‰ç»„åˆ
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) }
  }).lean();

  // 4. æ’é™¤å’Œå€¼åŒ¹é…çš„ç»„åˆ
  const filteredIds = new Set();
  let excludedCount = 0;

  for (const combo of combinations) {
    if (!historicalSums.has(combo.sum_value)) {
      filteredIds.add(combo.combination_id);
    } else {
      excludedCount++;
    }
  }

  return {
    filteredIds,
    excludedCount
  };
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
period = 10

// æœ€è¿‘10æœŸçš„å’Œå€¼
historicalSums = {78, 85, 92, 67, 105, 88, 73, 95, 81, 90}

// å€™é€‰ç»„åˆ
ç»„åˆ12345: sum = 78 â†’ å­˜åœ¨äºå†å²å’Œå€¼ â†’ âŒ æ’é™¤
ç»„åˆ12346: sum = 102 â†’ ä¸å­˜åœ¨äºå†å²å’Œå€¼ â†’ âœ… ä¿ç•™
ç»„åˆ12347: sum = 85 â†’ å­˜åœ¨äºå†å²å’Œå€¼ â†’ âŒ æ’é™¤

// è¾“å‡º
filteredIds = Set { 12346, ... }
excludedCount = 500  // çº¦ 5-15% çš„ç»„åˆè¢«æ’é™¤
```

---

### Exclude 2: å†å²è·¨åº¦æ’é™¤

**åŸç†**: æ’é™¤æœ€è¿‘NæœŸå†…å‡ºç°è¿‡çš„è·¨åº¦ç»„åˆã€‚

**ç®—æ³•**:
```javascript
async function exclude2_historicalSpan(candidateIds, period) {
  // 1. è·å–æœ€è¿‘NæœŸçš„å¼€å¥–æ•°æ®
  const recentIssues = await DLT.find()
    .sort({ Issue: -1 })
    .limit(period)
    .lean();

  // 2. è®¡ç®—æ¯æœŸçš„è·¨åº¦
  const historicalSpans = new Set(
    recentIssues.map(issue => {
      const redBalls = [issue.Red1, issue.Red2, issue.Red3, issue.Red4, issue.Red5];
      return Math.max(...redBalls) - Math.min(...redBalls);
    })
  );

  // 3. æŸ¥è¯¢å€™é€‰ç»„åˆ
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) }
  }).lean();

  // 4. æ’é™¤è·¨åº¦åŒ¹é…çš„ç»„åˆ
  const filteredIds = new Set();
  let excludedCount = 0;

  for (const combo of combinations) {
    if (!historicalSpans.has(combo.span_value)) {
      filteredIds.add(combo.combination_id);
    } else {
      excludedCount++;
    }
  }

  return {
    filteredIds,
    excludedCount
  };
}
```

---

### Exclude 3: å†å²çƒ­æ¸©å†·æ¯”æ’é™¤

**åŸç†**: æ’é™¤æœ€è¿‘NæœŸå†…å‡ºç°è¿‡çš„çƒ­æ¸©å†·æ¯”ç»„åˆã€‚

**ç®—æ³•**:
```javascript
async function exclude3_historicalHwc(candidateIds, period, baseIssue) {
  // 1. è·å–æœ€è¿‘NæœŸçš„å¼€å¥–æ•°æ®
  const recentIssues = await DLT.find()
    .sort({ Issue: -1 })
    .limit(period)
    .lean();

  // 2. è®¡ç®—æ¯æœŸçš„çƒ­æ¸©å†·æ¯”
  const historicalHwcRatios = new Set();

  for (const issue of recentIssues) {
    const redBalls = [issue.Red1, issue.Red2, issue.Red3, issue.Red4, issue.Red5];

    // è·å–åŸºå‡†æœŸçš„é—æ¼å€¼
    const missingData = await getMissingValuesForIssue(baseIssue);

    // åˆ†ç±»çƒ­æ¸©å†·
    let hotCount = 0, warmCount = 0, coldCount = 0;
    for (const ball of redBalls) {
      const missing = missingData[ball];
      if (missing <= 4) hotCount++;
      else if (missing >= 5 && missing <= 9) warmCount++;
      else coldCount++;
    }

    historicalHwcRatios.add(`${hotCount}:${warmCount}:${coldCount}`);
  }

  // 3. æŸ¥è¯¢å€™é€‰ç»„åˆçš„çƒ­æ¸©å†·æ¯”
  const hwcRecord = await DLTRedCombinationsHotWarmColdOptimized.findOne({
    base_issue: baseIssue
  }).lean();

  const hwcMap = hwcRecord.hwc_map;

  // 4. åå‘æŸ¥æ‰¾: æ‰¾å‡ºæ¯ä¸ªç»„åˆIDå¯¹åº”çš„çƒ­æ¸©å†·æ¯”
  const comboIdToHwc = new Map();
  for (const [ratio, ids] of hwcMap) {
    for (const id of ids) {
      if (candidateIds.has(id)) {
        comboIdToHwc.set(id, ratio);
      }
    }
  }

  // 5. æ’é™¤çƒ­æ¸©å†·æ¯”åŒ¹é…çš„ç»„åˆ
  const filteredIds = new Set();
  let excludedCount = 0;

  for (const id of candidateIds) {
    const hwcRatio = comboIdToHwc.get(id);
    if (!historicalHwcRatios.has(hwcRatio)) {
      filteredIds.add(id);
    } else {
      excludedCount++;
    }
  }

  return {
    filteredIds,
    excludedCount
  };
}
```

---

### Exclude 4: å†å²åŒºé—´æ¯”æ’é™¤

**åŸç†**: æ’é™¤æœ€è¿‘NæœŸå†…å‡ºç°è¿‡çš„åŒºé—´æ¯”ç»„åˆã€‚

**ç®—æ³•**: ç±»ä¼¼äºå†å²çƒ­æ¸©å†·æ¯”æ’é™¤ï¼ŒæŸ¥è¯¢ `zone_ratio` å­—æ®µã€‚

---

### Exclude 5: ç›¸å…‹å¯¹æ’é™¤

**åŸç†**: åŸºäºå†å²æ•°æ®ç»Ÿè®¡ï¼Œæ‰¾å‡ºä»æœªæˆ–æå°‘åŒæ—¶å‡ºç°çš„çƒå·å¯¹ï¼ˆç›¸å…‹å¯¹ï¼‰ï¼Œæ’é™¤åŒ…å«ç›¸å…‹å¯¹çš„ç»„åˆã€‚

**ç›¸å…‹å¯¹å®šä¹‰**: åœ¨ç»Ÿè®¡æœŸå†…åŒç°æ¬¡æ•° â‰¤ é˜ˆå€¼çš„çƒå·å¯¹ã€‚

**ç®—æ³•**:
```javascript
async function exclude5_conflictPairs(candidateIds, threshold, statisticsPeriod = 50) {
  // 1. è·å–æœ€è¿‘NæœŸçš„å¼€å¥–æ•°æ®
  const recentIssues = await DLT.find()
    .sort({ Issue: -1 })
    .limit(statisticsPeriod)
    .lean();

  // 2. ç»Ÿè®¡æ‰€æœ‰çƒå·å¯¹çš„åŒç°æ¬¡æ•°
  const pairCounts = new Map();  // Map<"çƒ1-çƒ2", æ¬¡æ•°>

  for (const issue of recentIssues) {
    const redBalls = [issue.Red1, issue.Red2, issue.Red3, issue.Red4, issue.Red5];

    // éå†æ‰€æœ‰çƒå·å¯¹
    for (let i = 0; i < redBalls.length; i++) {
      for (let j = i + 1; j < redBalls.length; j++) {
        const ball1 = redBalls[i];
        const ball2 = redBalls[j];
        const key = ball1 < ball2 ? `${ball1}-${ball2}` : `${ball2}-${ball1}`;

        pairCounts.set(key, (pairCounts.get(key) || 0) + 1);
      }
    }
  }

  // 3. æ‰¾å‡ºç›¸å…‹å¯¹ (åŒç°æ¬¡æ•° â‰¤ é˜ˆå€¼)
  const thresholdValue = threshold === "strict" ? 0 :
                         threshold === "loose" ? 1 : 2;

  const conflictPairs = new Set();
  for (const [pair, count] of pairCounts) {
    if (count <= thresholdValue) {
      conflictPairs.add(pair);
    }
  }

  // 4. æŸ¥è¯¢å€™é€‰ç»„åˆ
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) }
  }).lean();

  // 5. æ’é™¤åŒ…å«ç›¸å…‹å¯¹çš„ç»„åˆ
  const filteredIds = new Set();
  let excludedCount = 0;

  for (const combo of combinations) {
    let hasConflict = false;
    const balls = combo.balls;

    // æ£€æŸ¥ç»„åˆä¸­æ˜¯å¦åŒ…å«ç›¸å…‹å¯¹
    for (let i = 0; i < balls.length; i++) {
      for (let j = i + 1; j < balls.length; j++) {
        const ball1 = balls[i];
        const ball2 = balls[j];
        const key = ball1 < ball2 ? `${ball1}-${ball2}` : `${ball2}-${ball1}`;

        if (conflictPairs.has(key)) {
          hasConflict = true;
          break;
        }
      }
      if (hasConflict) break;
    }

    if (!hasConflict) {
      filteredIds.add(combo.combination_id);
    } else {
      excludedCount++;
    }
  }

  return {
    filteredIds,
    excludedCount
  };
}
```

**ç¤ºä¾‹**:
```javascript
// ç›¸å…‹å¯¹ç»Ÿè®¡ (æœ€è¿‘50æœŸ)
çƒå·å¯¹ "01-02": åŒç° 3æ¬¡
çƒå·å¯¹ "01-35": åŒç° 0æ¬¡ â†’ âœ… ç›¸å…‹å¯¹
çƒå·å¯¹ "03-15": åŒç° 1æ¬¡ â†’ âœ… ç›¸å…‹å¯¹ (å®½æ¾æ¨¡å¼)
çƒå·å¯¹ "07-22": åŒç° 8æ¬¡

// ç»„åˆ [01, 07, 15, 22, 35]
åŒ…å«çƒå·å¯¹ "01-35" (ç›¸å…‹å¯¹) â†’ âŒ æ’é™¤

// ç»„åˆ [03, 07, 12, 22, 28]
ä¸åŒ…å«ç›¸å…‹å¯¹ â†’ âœ… ä¿ç•™
```

---

### Exclude 6: åŒç°æ¯”æ’é™¤

**åŸç†**: åŸºäºå†å²æ•°æ®ç»Ÿè®¡ç‰¹å®šçƒå·ç»„åˆï¼ˆ2çƒ/3çƒ/4çƒï¼‰çš„åŒç°é¢‘ç‡ï¼Œæ’é™¤åŒç°æ¯”ä½äºé˜ˆå€¼çš„ç»„åˆã€‚

**ç®—æ³•**:
```javascript
async function exclude6_coOccurrence(candidateIds, type, threshold, statisticsPeriod = 30) {
  // 1. è·å–ç»Ÿè®¡æœŸå†…çš„å¼€å¥–æ•°æ®
  const recentIssues = await DLT.find()
    .sort({ Issue: -1 })
    .limit(statisticsPeriod)
    .lean();

  // 2. ç»Ÿè®¡æŒ‡å®šç±»å‹çš„åŒç°æ¬¡æ•°
  const comboOccurrences = new Map();  // Map<"çƒ1-çƒ2-..." , æ¬¡æ•°>

  for (const issue of recentIssues) {
    const redBalls = [issue.Red1, issue.Red2, issue.Red3, issue.Red4, issue.Red5].sort((a,b) => a-b);

    // æ ¹æ®ç±»å‹ç”Ÿæˆå­ç»„åˆ
    const subCombos = generateSubCombinations(redBalls, type);

    for (const combo of subCombos) {
      const key = combo.join('-');
      comboOccurrences.set(key, (comboOccurrences.get(key) || 0) + 1);
    }
  }

  // 3. æŸ¥è¯¢å€™é€‰ç»„åˆ
  const combinations = await DLTRedCombinations.find({
    combination_id: { $in: Array.from(candidateIds) }
  }).lean();

  // 4. æ£€æŸ¥æ¯ä¸ªå€™é€‰ç»„åˆçš„åŒç°æ¯”
  const filteredIds = new Set();
  let excludedCount = 0;

  for (const combo of combinations) {
    const balls = combo.balls;
    const subCombos = generateSubCombinations(balls, type);

    // è®¡ç®—å­ç»„åˆçš„å¹³å‡åŒç°æ¯”
    let totalOccurrences = 0;
    for (const subCombo of subCombos) {
      const key = subCombo.join('-');
      totalOccurrences += comboOccurrences.get(key) || 0;
    }

    const avgOccurrenceRate = (totalOccurrences / subCombos.length / statisticsPeriod) * 100;

    // åˆ¤æ–­æ˜¯å¦ä¿ç•™
    if (avgOccurrenceRate >= threshold) {
      filteredIds.add(combo.combination_id);
    } else {
      excludedCount++;
    }
  }

  return {
    filteredIds,
    excludedCount
  };
}

// ç”Ÿæˆå­ç»„åˆ
function generateSubCombinations(balls, type) {
  const n = type === 'combo_2' ? 2 : type === 'combo_3' ? 3 : 4;
  // ç”Ÿæˆ C(5, n) çš„ç»„åˆ
  return combinations(balls, n);
}
```

**ç¤ºä¾‹**:
```javascript
// è¾“å…¥
type = "combo_2"
threshold = 10%
statisticsPeriod = 30æœŸ

// ç»„åˆ [03, 07, 15, 22, 31] çš„2çƒå­ç»„åˆ
å­ç»„åˆ: [03-07], [03-15], [03-22], [03-31], [07-15], [07-22], [07-31], [15-22], [15-31], [22-31]

// æ¯ä¸ªå­ç»„åˆçš„åŒç°æ¬¡æ•° (30æœŸå†…)
[03-07]: 2æ¬¡ â†’ åŒç°æ¯” 6.67%
[03-15]: 4æ¬¡ â†’ åŒç°æ¯” 13.33%
[03-22]: 1æ¬¡ â†’ åŒç°æ¯” 3.33%
...
å¹³å‡åŒç°æ¯”: 8.5% < 10% â†’ âŒ æ’é™¤

// ç»„åˆ [05, 12, 18, 25, 32] çš„å¹³å‡åŒç°æ¯”: 15% â‰¥ 10% â†’ âœ… ä¿ç•™
```

---

## ğŸ“ˆ å‘½ä¸­ç»Ÿè®¡åˆ†æ

### å¥–çº§åˆ¤æ–­è§„åˆ™

**å¤§ä¹é€å¥–çº§è§„åˆ™**:
```javascript
function judgePrize(redHit, blueHit) {
  if (redHit === 5 && blueHit === 2) return 'ä¸€ç­‰å¥–';
  if (redHit === 5 && blueHit === 1) return 'äºŒç­‰å¥–';
  if (redHit === 5 && blueHit === 0) return 'ä¸‰ç­‰å¥–';
  if (redHit === 4 && blueHit === 2) return 'å››ç­‰å¥–';
  if (redHit === 4 && blueHit === 1) return 'äº”ç­‰å¥–';
  if (redHit === 3 && blueHit === 2) return 'å…­ç­‰å¥–';
  if (redHit === 4 && blueHit === 0) return 'ä¸ƒç­‰å¥–';
  if ((redHit === 3 && blueHit === 1) || (redHit === 2 && blueHit === 2)) return 'å…«ç­‰å¥–';
  if ((redHit === 3 && blueHit === 0) || (redHit === 2 && blueHit === 1) ||
      (redHit === 1 && blueHit === 2) || (redHit === 0 && blueHit === 2)) return 'ä¹ç­‰å¥–';

  return null;  // æœªä¸­å¥–
}
```

### å‘½ä¸­åˆ†æç®—æ³•

```javascript
async function calculateHitAnalysis(redComboIds, blueComboIds, winningNumbers, pairingMode) {
  // 1. æŸ¥è¯¢çº¢çƒå’Œè“çƒç»„åˆæ•°æ®
  const redCombinations = await DLTRedCombinations.find({
    combination_id: { $in: redComboIds }
  }).lean();

  const blueCombinations = await DLTBlueCombinations.find({
    combination_id: { $in: blueComboIds }
  }).lean();

  // 2. æå–å¼€å¥–å·ç 
  const winningRed = winningNumbers.red;
  const winningBlue = winningNumbers.blue;

  // 3. åˆå§‹åŒ–ç»Ÿè®¡æ•°æ®
  const prizeDistribution = {
    'ä¸€ç­‰å¥–': 0,
    'äºŒç­‰å¥–': 0,
    'ä¸‰ç­‰å¥–': 0,
    'å››ç­‰å¥–': 0,
    'äº”ç­‰å¥–': 0,
    'å…­ç­‰å¥–': 0,
    'ä¸ƒç­‰å¥–': 0,
    'å…«ç­‰å¥–': 0,
    'ä¹ç­‰å¥–': 0
  };

  let hitCombinations = 0;
  let totalPrize = 0;
  let maxRedHit = 0;
  let maxBlueHit = 0;

  // 4. æ ¹æ®é…å¯¹æ¨¡å¼è®¡ç®—å‘½ä¸­
  if (pairingMode === 'default' || pairingMode === 'unlimited') {
    // å›ºå®šé…å¯¹: 1çº¢ : 1è“
    for (let i = 0; i < redCombinations.length; i++) {
      const redCombo = redCombinations[i];
      const blueCombo = blueCombinations[i % blueCombinations.length];

      const redHit = redCombo.balls.filter(b => winningRed.includes(b)).length;
      const blueHit = blueCombo.balls.filter(b => winningBlue.includes(b)).length;

      maxRedHit = Math.max(maxRedHit, redHit);
      maxBlueHit = Math.max(maxBlueHit, blueHit);

      const prizeLevel = judgePrize(redHit, blueHit);
      if (prizeLevel) {
        hitCombinations++;
        prizeDistribution[prizeLevel]++;
        totalPrize += getPrizeAmount(prizeLevel);
      }
    }
  } else if (pairingMode === 'truly-unlimited') {
    // å®Œå…¨é…å¯¹: Mçº¢ Ã— Nè“
    for (const redCombo of redCombinations) {
      for (const blueCombo of blueCombinations) {
        const redHit = redCombo.balls.filter(b => winningRed.includes(b)).length;
        const blueHit = blueCombo.balls.filter(b => winningBlue.includes(b)).length;

        maxRedHit = Math.max(maxRedHit, redHit);
        maxBlueHit = Math.max(maxBlueHit, blueHit);

        const prizeLevel = judgePrize(redHit, blueHit);
        if (prizeLevel) {
          hitCombinations++;
          prizeDistribution[prizeLevel]++;
          totalPrize += getPrizeAmount(prizeLevel);
        }
      }
    }
  }

  // 5. è®¡ç®—æ€»ç»„åˆæ•°å’Œå‘½ä¸­ç‡
  const totalCombinations = pairingMode === 'truly-unlimited'
    ? redCombinations.length * blueCombinations.length
    : redCombinations.length;

  const hitRate = (hitCombinations / totalCombinations) * 100;

  // 6. è¿”å›å®Œæ•´ç»Ÿè®¡
  return {
    total_combinations: totalCombinations,
    hit_combinations: hitCombinations,
    hit_rate: hitRate.toFixed(2),
    prize_distribution: prizeDistribution,
    total_prize: totalPrize,
    max_red_hit: maxRedHit,
    max_blue_hit: maxBlueHit
  };
}

// å¥–é‡‘é‡‘é¢è¡¨ (å›ºå®šå¥–é‡‘éƒ¨åˆ†)
function getPrizeAmount(prizeLevel) {
  const prizeAmounts = {
    'ä¸€ç­‰å¥–': 5000000,  // æµ®åŠ¨å¥–é‡‘ï¼Œè¿™é‡Œä½¿ç”¨ä¼°ç®—å€¼
    'äºŒç­‰å¥–': 100000,   // æµ®åŠ¨å¥–é‡‘
    'ä¸‰ç­‰å¥–': 10000,
    'å››ç­‰å¥–': 3000,
    'äº”ç­‰å¥–': 300,
    'å…­ç­‰å¥–': 200,
    'ä¸ƒç­‰å¥–': 100,
    'å…«ç­‰å¥–': 15,
    'ä¹ç­‰å¥–': 5
  };
  return prizeAmounts[prizeLevel] || 0;
}
```

---

## ğŸ“¥ Excelå¯¼å‡º

### å¯¼å‡ºç»“æ„

**Sheet 1: é¢„æµ‹ç»„åˆè¡¨**
```
| åºå· | çº¢çƒç»„åˆ | è“çƒç»„åˆ | å’Œå€¼ | è·¨åº¦ | åŒºé—´æ¯” | å¥‡å¶æ¯” | çƒ­æ¸©å†·æ¯” | ACå€¼ | è¿å·æƒ…å†µ | çº¢çƒå‘½ä¸­ | è“çƒå‘½ä¸­ | ä¸­å¥–ç­‰çº§ |
|------|---------|---------|------|------|-------|-------|---------|------|---------|---------|---------|---------|
| 1    | 03 07 15 22 31 | 05 09 | 78 | 28 | 2:2:1 | 3:2 | 3:2:0 | 7 | æ—  | 3 | 1 | å…«ç­‰å¥– |
| 2    | 05 12 18 25 32 | 05 09 | 92 | 27 | 1:2:2 | 2:3 | 2:2:1 | 8 | æ—  | 2 | 2 | å…«ç­‰å¥– |
| ...  | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... |
```

**Sheet 2: çº¢çƒæ’é™¤è¯¦æƒ…** (å¾…å®ç°)
```
| çº¢çƒç»„åˆ | å’Œå€¼ | è·¨åº¦ | åŒºé—´æ¯” | å¥‡å¶æ¯” | çƒ­æ¸©å†·æ¯” | ACå€¼ | è¿å·æƒ…å†µ | æ’é™¤åŸå›  |
|---------|------|------|-------|-------|---------|------|---------|---------|
| 01 05 12 23 35 | 76 | 34 | 2:1:2 | 3:2 | 4:1:0 | 9 | æ—  | å†å²å’Œå€¼æ’é™¤: 76åœ¨æœ€è¿‘10æœŸå‡ºç° |
| 02 08 15 22 30 | 77 | 28 | 2:2:1 | 2:3 | 2:2:1 | 8 | æ—  | ç›¸å…‹å¯¹æ’é™¤: åŒ…å«ç›¸å…‹å¯¹ 02-30 |
| ...  | ... | ... | ... | ... | ... | ... | ... | ... |
```

**Sheet 3: æ’é™¤ç»Ÿè®¡è¡¨**
```
| æ’é™¤æ¡ä»¶ | æ’é™¤ç»„åˆæ•° | æ’é™¤ç™¾åˆ†æ¯” |
|---------|----------|-----------|
| æ­£é€‰ç­›é€‰å | 25,000 | - |
| å†å²å’Œå€¼æ’é™¤ | 1,200 | 4.80% |
| å†å²è·¨åº¦æ’é™¤ | 800 | 3.20% |
| å†å²çƒ­æ¸©å†·æ¯”æ’é™¤ | 600 | 2.40% |
| å†å²åŒºé—´æ¯”æ’é™¤ | 500 | 2.00% |
| ç›¸å…‹å¯¹æ’é™¤ | 2,400 | 9.60% |
| åŒç°æ¯”æ’é™¤ | 1,000 | 4.00% |
| æœ€ç»ˆä¿ç•™ | 18,500 | 74.00% |
```

### å¯¼å‡ºAPI

**Endpoint**: `GET /api/dlt/hwc-positive-tasks/:task_id/period/:period/export`

**å®ç°ä½ç½®**: `src/server/server.js` (å¾…æ·»åŠ )

**ä½¿ç”¨**: è§ `HWC_POSITIVE_TASK_ENHANCEMENT_IMPLEMENTATION.md` ç¬¬250-496è¡Œ

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®é‡çº§

| é¡¹ç›® | æ•°é‡ | è¯´æ˜ |
|-----|------|------|
| çº¢çƒç»„åˆæ€»æ•° | 324,632 | C(35,5) |
| è“çƒç»„åˆæ€»æ•° | 66 | C(12,2) |
| 100æœŸçš„æœŸå·å¯¹æ•° | 4,950 | C(100,2) ç›¸é‚»é…å¯¹ |
| çƒ­æ¸©å†·ä¼˜åŒ–è¡¨è®°å½•æ•° | è§†æœŸå·èŒƒå›´ | æ¯ä¸ªæœŸå·å¯¹1æ¡è®°å½• |

### æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | è€—æ—¶ | ä¼˜åŒ–å‰ | ä¼˜åŒ–æ‰‹æ®µ |
|-----|------|-------|---------|
| çƒ­æ¸©å†·æ¯”æŸ¥è¯¢ (Map) | 5-10ms | 5-10ç§’ | é¢„è®¡ç®— + Mapæ•°æ®ç»“æ„ |
| 6æ­¥æ­£é€‰ç­›é€‰ (å•æœŸ) | 50-100ms | 10-20ç§’ | æ•°æ®åº“ç´¢å¼• + Seté›†åˆè¿ç®— |
| æ’é™¤æ¡ä»¶ç­›é€‰ (å•æœŸ) | 100-200ms | 30ç§’-1åˆ†é’Ÿ | æ‰¹é‡æŸ¥è¯¢ + ç¼“å­˜ |
| å•æœŸå®Œæ•´å¤„ç† | 0.3-0.5ç§’ | 1-2åˆ†é’Ÿ | ç»¼åˆä¼˜åŒ– |
| 100æœŸæ‰¹é‡å¤„ç† | 30-50ç§’ | 100-200åˆ†é’Ÿ | å¼‚æ­¥å¤„ç† + è¿›åº¦è¿½è¸ª |
| 2000æœŸå…¨é‡å¤„ç† | 10-17åˆ†é’Ÿ | 33-66å°æ—¶ | æ€§èƒ½æå‡ **120-235å€** |

### ä¼˜åŒ–æŠ€æœ¯

1. **çƒ­æ¸©å†·ä¼˜åŒ–è¡¨** (æ€§èƒ½æå‡ 1000å€)
   - é¢„è®¡ç®—æ‰€æœ‰æœŸå·å¯¹çš„çƒ­æ¸©å†·æ¯”æ•°æ®
   - ä½¿ç”¨ Map æ•°æ®ç»“æ„å­˜å‚¨: `Map<çƒ­æ¸©å†·æ¯”, ç»„åˆID[]>`
   - O(1) æ—¶é—´å¤æ‚åº¦æŸ¥æ‰¾

2. **MongoDBç´¢å¼•**
   ```javascript
   // DLTRedCombinations ç´¢å¼•
   {
     combination_id: 1,
     sum_value: 1,
     span_value: 1,
     zone_ratio: 1,
     odd_even_ratio: 1,
     ac_value: 1
   }
   ```

3. **Seté›†åˆè¿ç®—**
   ```javascript
   // ä½¿ç”¨ Set è¿›è¡Œå¿«é€Ÿäº¤é›†/å·®é›†è¿ç®—
   const filteredIds = new Set(
     candidateIds.filter(id => condition(id))
   );
   ```

4. **æ‰¹é‡æ•°æ®åº“æŸ¥è¯¢**
   ```javascript
   // ä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰å€™é€‰ç»„åˆæ•°æ®
   const combinations = await DLTRedCombinations.find({
     combination_id: { $in: Array.from(candidateIds) }
   }).lean();
   ```

5. **å¼‚æ­¥ä»»åŠ¡å¤„ç†**
   ```javascript
   // ä»»åŠ¡åˆ›å»ºåç«‹å³è¿”å›ï¼Œåå°å¼‚æ­¥å¤„ç†
   res.json({ success: true, taskId });
   processHwcPositiveTask(taskId);  // å¼‚æ­¥
   ```

6. **è¿›åº¦å®æ—¶æ›´æ–°**
   ```javascript
   // æ¯å¤„ç†å®Œä¸€æœŸï¼Œæ›´æ–°ä»»åŠ¡è¿›åº¦
   await HwcPositivePredictionTask.updateOne(
     { task_id: taskId },
     {
       $set: {
         progress: (processedCount / totalCount) * 100,
         status: 'processing'
       }
     }
   );
   ```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: ä»»åŠ¡åˆ›å»ºå¤±è´¥

**ç—‡çŠ¶**: ç‚¹å‡»"åˆ›å»ºä»»åŠ¡"æŒ‰é’®åï¼Œæç¤ºåˆ›å»ºå¤±è´¥

**æ’æŸ¥æ­¥éª¤**:
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12)ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿— (npm start çª—å£)
3. éªŒè¯é…ç½®æ˜¯å¦å®Œæ•´:
   - è‡³å°‘é€‰æ‹©1ç§çƒ­æ¸©å†·æ¯”
   - è‡³å°‘å¯ç”¨1ä¸ªå’Œå€¼æˆ–è·¨åº¦èŒƒå›´

**å¸¸è§åŸå› **:
- æœªé€‰æ‹©ä»»ä½•æ­£é€‰æ¡ä»¶
- MongoDBè¿æ¥æ–­å¼€
- æœŸå·èŒƒå›´è§£æå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥MongoDBçŠ¶æ€
net start MongoDB

# 2. é‡å¯åº”ç”¨
npm start

# 3. æ£€æŸ¥æ•°æ®åº“è¿æ¥
node check-all-collections.js
```

---

### é—®é¢˜2: çƒ­æ¸©å†·æ•°æ®è¦†ç›–ç‡ä½

**ç—‡çŠ¶**: ç‚¹å‡»"æ£€æŸ¥æ•°æ®è¦†ç›–ç‡"æ˜¾ç¤ºè¦†ç›–ç‡ < 50%

**åŸå› **: çƒ­æ¸©å†·ä¼˜åŒ–è¡¨æ•°æ®ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆ**:
1. ç‚¹å‡»"ç”Ÿæˆç¼ºå¤±æ•°æ®"æŒ‰é’®
2. ç­‰å¾…ç”Ÿæˆå®Œæˆï¼ˆå¯èƒ½éœ€è¦5-15åˆ†é’Ÿï¼‰
3. é‡æ–°æ£€æŸ¥è¦†ç›–ç‡

**æ‰‹åŠ¨ç”Ÿæˆ**:
```bash
# è¿è¡Œçƒ­æ¸©å†·ä¼˜åŒ–è¡¨ç”Ÿæˆè„šæœ¬
node update-hwc-optimized.js
```

---

### é—®é¢˜3: ä»»åŠ¡ä¸€ç›´å¤„äº processing çŠ¶æ€

**ç—‡çŠ¶**: ä»»åŠ¡åˆ›å»ºåé•¿æ—¶é—´æ²¡æœ‰å®Œæˆ

**æ’æŸ¥æ­¥éª¤**:
1. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œç¡®è®¤ä»»åŠ¡æ˜¯å¦åœ¨å¤„ç†
2. æ£€æŸ¥æ•°æ®åº“ä¸­çš„ä»»åŠ¡çŠ¶æ€:
   ```bash
   node monitor-task.js
   ```
3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—

**å¸¸è§åŸå› **:
- æ•°æ®é‡è¿‡å¤§ï¼ˆæœŸå·èŒƒå›´è¿‡é•¿ï¼‰
- æ•°æ®åº“æŸ¥è¯¢è¶…æ—¶
- æœåŠ¡å™¨å´©æºƒ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
use lottery
db.HwcPositivePredictionTask.find({ status: 'processing' }).pretty()

# 2. å¦‚æœä»»åŠ¡å¡æ­»ï¼Œæ‰‹åŠ¨æ ‡è®°ä¸ºå¤±è´¥
db.HwcPositivePredictionTask.updateOne(
  { task_id: 'å¡æ­»çš„ä»»åŠ¡ID' },
  { $set: { status: 'failed', error_message: 'ä»»åŠ¡è¶…æ—¶' } }
)

# 3. é‡æ–°åˆ›å»ºä»»åŠ¡ï¼Œç¼©å°æœŸå·èŒƒå›´
```

---

### é—®é¢˜4: æ’é™¤æ¡ä»¶ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**: å¯ç”¨æ’é™¤æ¡ä»¶åï¼Œä¿ç•™çš„ç»„åˆæ•°é‡æ²¡æœ‰å‡å°‘

**åŸå› **: æ’é™¤æ¡ä»¶é€»è¾‘å°šæœªå®Œå…¨å®ç° (å½“å‰ä¸ºæ¡†æ¶ä»£ç )

**çŠ¶æ€**: ğŸš§ å¾…å®ç° (è§ `çƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹-å®æ–½æ€»ç»“.md` ç¬¬ 426-474è¡Œ)

**ä¸´æ—¶æ–¹æ¡ˆ**: ç›®å‰ä»…æ­£é€‰æ¡ä»¶ç”Ÿæ•ˆï¼Œæ’é™¤æ¡ä»¶åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­

---

### é—®é¢˜5: Excelå¯¼å‡ºå¤±è´¥

**ç—‡çŠ¶**: ç‚¹å‡»"å¯¼å‡º"æŒ‰é’®åæ²¡æœ‰ä¸‹è½½æ–‡ä»¶

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. ç¡®è®¤å¯¼å‡ºAPIæ˜¯å¦å·²æ·»åŠ 
3. æ£€æŸ¥ExcelJSä¾èµ–æ˜¯å¦å®‰è£…

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. å®‰è£…ExcelJS
npm install exceljs

# 2. ç¡®è®¤å¯¼å‡ºAPIå·²æ·»åŠ åˆ° server.js
# ä½ç½®: src/server/server.js ç¬¬18000è¡Œé™„è¿‘

# 3. é‡å¯åº”ç”¨
npm start
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç›¸å…³æ–‡æ¡£

- `çƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹-å®æ–½æ€»ç»“.md` - åŠŸèƒ½å®æ–½æ€»ç»“
- `HWC_POSITIVE_TASK_ENHANCEMENT_IMPLEMENTATION.md` - å¢å¼ºåŠŸèƒ½å®æ–½æŒ‡å—
- `FINAL_IMPLEMENTATION_SUMMARY.md` - æœ€ç»ˆå®æ–½æ€»ç»“
- `CLAUDE.md` - é¡¹ç›®æ€»ä½“æ¶æ„è¯´æ˜
- `ç»„åˆæ‰¹é‡é¢„æµ‹-çƒ­æ¸©å†·æ¯”é€»è¾‘è¯´æ˜.md` - çƒ­æ¸©å†·æ¯”é€»è¾‘è¯¦è§£

### å…³é”®ä»£ç ä½ç½®

#### å‰ç«¯
- **UIç»“æ„**: `src/renderer/index.html:2546-3402` (857è¡Œ)
- **JavaScripté€»è¾‘**: `src/renderer/dlt-module.js:15740-16343` (603è¡Œ)
- **åˆå§‹åŒ–å‡½æ•°**: `initHwcPositivePrediction()`
- **äº‹ä»¶ç›‘å¬å™¨**: `initHwcEventListeners()`
- **ä»»åŠ¡åˆ›å»º**: `createHwcPositiveTask()`

#### åç«¯
- **Schemaå®šä¹‰**: `src/server/server.js:1014-1197` (183è¡Œ)
- **API 1 (æ£€æŸ¥è¦†ç›–ç‡)**: `src/server/server.js:13639-13730`
- **API 2 (ç”Ÿæˆç¼ºå¤±æ•°æ®)**: `src/server/server.js:13736-13822`
- **API 3 (æ­£é€‰ç­›é€‰)**: `src/server/server.js:13828-13936`
- **API 4 (åˆ›å»ºä»»åŠ¡)**: `src/server/server.js:13942-14006`
- **å¼‚æ­¥å¤„ç†å‡½æ•°**: `processHwcPositiveTask()` (src/server/server.js:14011-14099)

#### æ•°æ®åº“
- **çƒ­æ¸©å†·ä¼˜åŒ–è¡¨ç”Ÿæˆ**: `update-hwc-optimized.js`
- **ä»»åŠ¡ç›‘æ§**: `monitor-task.js`
- **æ•°æ®æ£€æŸ¥**: `check-all-collections.js`

---

## ğŸ¯ æ€»ç»“

çƒ­æ¸©å†·æ­£é€‰æ‰¹é‡é¢„æµ‹åŠŸèƒ½é€šè¿‡**6æ­¥æ­£é€‰ + 5æ­¥æ’é™¤**çš„åŒé‡ç­›é€‰ç­–ç•¥ï¼Œç»“åˆçƒ­æ¸©å†·ä¼˜åŒ–è¡¨çš„é¢„è®¡ç®—æ•°æ®ï¼Œå®ç°äº†é«˜æ•ˆã€çµæ´»çš„ç»„åˆç­›é€‰ã€‚

### æ ¸å¿ƒä¼˜åŠ¿

1. **æ­£å‘æ€ç»´**: å…ˆé€‰æ‹©æœŸæœ›ç‰¹å¾ï¼Œå†æ’é™¤ä¸æœŸæœ›ç‰¹å¾
2. **é«˜æ€§èƒ½**: çƒ­æ¸©å†·ä¼˜åŒ–è¡¨å¸¦æ¥1000å€æ€§èƒ½æå‡
3. **çµæ´»é…ç½®**: 21ç§çƒ­æ¸©å†·æ¯”ã€21ç§åŒºé—´æ¯”ã€å¤šç§å’Œå€¼/è·¨åº¦èŒƒå›´ç­‰
4. **å‘½ä¸­åˆ†æ**: è‡ªåŠ¨è®¡ç®—å†å²å‘½ä¸­æƒ…å†µï¼Œæ”¯æŒ9ä¸ªå¥–çº§ç»Ÿè®¡
5. **Excelå¯¼å‡º**: å¤šSheetå¯¼å‡ºï¼ŒåŒ…å«æ’é™¤ç»Ÿè®¡å’Œå‘½ä¸­åˆ†æ

### ä½¿ç”¨åœºæ™¯

- **è¶‹åŠ¿é¢„æµ‹**: åŸºäºçƒ­æ¸©å†·æ¯”åˆ†æï¼Œæ•æ‰å·ç å†·çƒ­è¶‹åŠ¿
- **åŒºé—´å¹³è¡¡**: é€‰æ‹©åŒºé—´åˆ†å¸ƒå‡è¡¡çš„ç»„åˆ
- **ç‰¹å¾ç­›é€‰**: æ ¹æ®å’Œå€¼ã€è·¨åº¦ã€å¥‡å¶æ¯”ç­‰ç‰¹å¾ç²¾å‡†ç­›é€‰
- **å†å²è§„é¿**: é¿å…é‡å¤å†å²æ¨¡å¼
- **æ™ºèƒ½æ’é™¤**: åŸºäºç›¸å…‹å¯¹å’ŒåŒç°æ¯”æ’é™¤ä¸åˆç†ç»„åˆ

### æœªæ¥å±•æœ›

- **å®Œå–„æ’é™¤æ¡ä»¶é€»è¾‘** (5ä¸ªæ’é™¤æ¡ä»¶)
- **å®ç°Excelæ’é™¤æ˜ç»†Sheet**
- **ä¼˜åŒ–å¯¼å‡ºæ€§èƒ½** (æ”¯æŒè¶…å¤§æ•°æ®é‡)
- **æ·»åŠ å¯è§†åŒ–åˆ†æ** (å›¾è¡¨å±•ç¤ºæ’é™¤æ•ˆæœ)
- **æ”¯æŒè‡ªå®šä¹‰æƒé‡** (ä¸ºä¸åŒæ¡ä»¶è®¾ç½®æƒé‡)

---

**æ–‡æ¡£ç»“æŸ**

å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒä¸Šè¿°ç›¸å…³æ–‡æ¡£æˆ–æŸ¥çœ‹æºä»£ç ã€‚
