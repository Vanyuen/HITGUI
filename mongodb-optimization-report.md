# MongoDBé«˜å ç”¨é—®é¢˜ - å®Œæ•´åˆ†æä¸ä¼˜åŒ–æ–¹æ¡ˆ

## ğŸ“Š è¯Šæ–­ç»“æœæ€»ç»“

### å½“å‰çŠ¶æ€
- **MongoDBå†…å­˜å ç”¨**: 9.2 GB å¸¸é©»å†…å­˜ + 20.7 GB è™šæ‹Ÿå†…å­˜
- **æ•°æ®åº“æ€»å¤§å°**: 12.7 GB (æ•°æ®) + 3.7 GB (ç´¢å¼•)
- **è¿æ¥æ•°**: 303 ä¸ª (å¼‚å¸¸é«˜ï¼Œæ­£å¸¸åº”ä¸º10-50)
- **WiredTigerç¼“å­˜**: 9.4 GB / 15.8 GB

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜å®šä½

### é—®é¢˜1: çƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨ä½“ç§¯å·¨å¤§ â­æœ€ä¸¥é‡

**é›†åˆå**: `hit_dlt_redcombinationshotwarmcoldoptimizeds`

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| æ•°æ®å¤§å° | 9.1 GB | å æ€»æ•°æ®70% |
| å­˜å‚¨å¤§å° | 5.3 GB | ç£ç›˜å®é™…å ç”¨ |
| æ–‡æ¡£æ•° | 2,788 æ¡ | æ¯æœŸä¸€æ¡ |
| å¹³å‡æ–‡æ¡£å¤§å° | **3.42 MB** | æ¯ä¸ªæ–‡æ¡£è¶…å¤§ |
| ç´¢å¼•æ•° | 4 ä¸ª | æ­£å¸¸ |

**æ•°æ®ç»“æ„åˆ†æ**:
```javascript
{
  _id: ObjectId("..."),
  base_issue: "7001",           // åŸºå‡†æœŸå·
  target_issue: "7002",         // ç›®æ ‡æœŸå·
  hot_warm_cold_data: {
    "5:0:0": [1, 2, 3, ...],    // æ¯ä¸ªçƒ­æ¸©å†·æ¯”å¯¹åº”ä¸€ä¸ªç»„åˆIDæ•°ç»„
    "4:1:0": [10, 20, ...],
    "3:2:0": [100, 200, ...],
    // ... çº¦15-20ä¸ªçƒ­æ¸©å†·æ¯”
    // æ¯ä¸ªæ¯”ä¾‹å¯èƒ½åŒ…å«æ•°ä¸‡ä¸ªç»„åˆID
  },
  total_combinations: 324632
}
```

**ä¸ºä»€ä¹ˆä½“ç§¯è¿™ä¹ˆå¤§ï¼Ÿ**

1. **æ¯ä¸ªæ–‡æ¡£å­˜å‚¨324,632ä¸ªç»„åˆID**
   - æ¯ä¸ªID: 4 bytes (Numberç±»å‹)
   - 324,632 Ã— 4 = 1.3 MB (çº¯IDæ•°æ®)
   - åŠ ä¸ŠMapç»“æ„å¼€é”€å’ŒBSONæ ¼å¼ = **3.4 MB/æ–‡æ¡£**

2. **2,788ä¸ªæ–‡æ¡£**
   - 2,788æœŸå†å²æ•°æ® Ã— 3.4 MB = **9.1 GB**

3. **è¿™æ˜¯"é¢„å¤„ç†ä¼˜åŒ–"çš„è®¾è®¡ç›®çš„**
   - **é—®é¢˜èƒŒæ™¯**: å®æ—¶è®¡ç®—çƒ­æ¸©å†·æ¯”å¯¼è‡´æ‰¹é‡é¢„æµ‹å¤šæœŸæ—¶å†…å­˜ä¸è¶³ã€è¿è¡Œæ…¢
   - **ä¼˜åŒ–ç­–ç•¥**: é¢„å…ˆè®¡ç®—æ‰€æœ‰ç»„åˆçš„çƒ­æ¸©å†·æ¯”ï¼Œå­˜å‚¨åˆ°æ•°æ®åº“
   - **æŸ¥è¯¢æ€§èƒ½**: ä»3-5ç§’é™è‡³0.5-1ç§’ (3-5å€æå‡)
   - **ä»£ä»·**: å ç”¨9.1 GBå­˜å‚¨ç©ºé—´

---

### é—®é¢˜2: æ’é™¤è¯¦æƒ…è¡¨ç´¢å¼•è¿‡å¤š

**é›†åˆå**: `hit_dlt_exclusiondetails`

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ•°æ®å¤§å° | 3.4 GB |
| **ç´¢å¼•å¤§å°** | **3.7 GB** (è¶…è¿‡æ•°æ®æœ¬èº«!) |
| æ–‡æ¡£æ•° | 6,955 æ¡ |
| ç´¢å¼•æ•° | **10 ä¸ª** (è¿‡å¤š) |

**ç´¢å¼•åˆ—è¡¨**:
1. `_id` (é»˜è®¤)
2. `task_id`
3. `issue_pair`
4. `created_at`
5. `sum_condition` â† å¯åˆ é™¤
6. `span_condition` â† å¯åˆ é™¤
7. `zone_ratio_condition` â† å¯åˆ é™¤
8. `odd_even_ratio_condition` â† å¯åˆ é™¤
9. `hot_warm_cold_condition` â† å¯åˆ é™¤
10. å…¶ä»–...

**é—®é¢˜**: æ¡ä»¶å­—æ®µç´¢å¼•å¾ˆå°‘ç”¨äºæŸ¥è¯¢ï¼Œå´å ç”¨å¤§é‡ç©ºé—´

---

### é—®é¢˜3: çº¢çƒç»„åˆè¡¨å†—ä½™ç´¢å¼•

**é›†åˆå**: `hit_dlt_redcombinations`

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| ç´¢å¼•æ•° | **17 ä¸ª** (ä¸¥é‡è¿‡å¤š) |
| ç´¢å¼•å¤§å° | 25.87 MB |
| æ–‡æ¡£æ•° | 324,632 |

**å†—ä½™ç´¢å¼•å¯¹**:
- `sum` å’Œ `sum_value` (é‡å¤)
- `sumRange` å’Œ `sum_value` (é‡å¤)
- `zoneRatio` å’Œ `zone_ratio` (é‡å¤)
- `evenOddRatio` å’Œ `odd_even_ratio` (é‡å¤)
- `consecutiveCount` å’Œå…¶ä»–è¿å·å­—æ®µ (é‡å¤)

**é—®é¢˜**: å­—æ®µé‡å‘½ååæœªåˆ é™¤æ—§ç´¢å¼•ï¼Œå¯¼è‡´åŒå€ç´¢å¼•

---

### é—®é¢˜4: è¿æ¥æ•°å¼‚å¸¸é«˜

**å½“å‰çŠ¶æ€**:
- è¿æ¥æ•°: **303 ä¸ª**
- æ­£å¸¸å€¼: 10-50 ä¸ª

**åŸå› æ¨æµ‹**:
1. è¿æ¥æ± é…ç½®æœªé™åˆ¶æœ€å¤§è¿æ¥æ•°
2. è¿æ¥æœªæ­£ç¡®å…³é—­ï¼Œå‡ºç°æ³„æ¼
3. Electronåº”ç”¨å¤šæ¬¡é‡å¯å¯¼è‡´æ—§è¿æ¥æœªé‡Šæ”¾

---

## ğŸ’¡ ä¼˜åŒ–æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆA: ä¿å®ˆä¼˜åŒ– (æ¨è) âœ…

**æ ¸å¿ƒæ€æƒ³**: ä¿ç•™çƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨ï¼Œä»…ä¼˜åŒ–æ¬¡è¦é—®é¢˜

**ä¼˜åŒ–å†…å®¹**:
1. âœ… åˆ é™¤å†—ä½™ç´¢å¼• (é‡Šæ”¾ ~15 MB)
2. âœ… ä¼˜åŒ–æ’é™¤è¯¦æƒ…ç´¢å¼• (é‡Šæ”¾ ~1.5 GB)
3. âœ… ä¿®å¤è¿æ¥æ± é…ç½® (è¿æ¥æ•°é™è‡³10-20)
4. âœ… é…ç½®WiredTigerç¼“å­˜é™åˆ¶ (é™åˆ¶ä¸º4GB)
5. âœ… æ¸…ç†æ—§çš„æ’é™¤è¯¦æƒ…æ•°æ® (ä¿ç•™æœ€è¿‘30å¤©)

**é¢„æœŸæ•ˆæœ**:
- MongoDBå†…å­˜å ç”¨: 9.2 GB â†’ **4-5 GB** (å‡å°‘50%)
- è¿æ¥æ•°: 303 â†’ **10-20** (æ­£å¸¸)
- åŠŸèƒ½å½±å“: **æ— ** (æ‰¹é‡é¢„æµ‹æ€§èƒ½ä¿æŒä¸å˜)
- é£é™©ç­‰çº§: **ä½** ğŸŸ¢

---

### æ–¹æ¡ˆB: æ¿€è¿›ä¼˜åŒ– (é«˜é£é™©) âš ï¸

**æ ¸å¿ƒæ€æƒ³**: åˆ é™¤çƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨ï¼Œæ”¹ç”¨æ™ºèƒ½ç¼“å­˜ç­–ç•¥

**ä¼˜åŒ–å†…å®¹**:
1. âŒ åˆ é™¤æ•´ä¸ªçƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨ (é‡Šæ”¾ 5.3 GB)
2. ğŸ”„ å®æ–½ä»¥ä¸‹ä¸‰é€‰ä¸€ç­–ç•¥:

#### ç­–ç•¥B1: Redisç¼“å­˜ + å®æ—¶è®¡ç®—
```javascript
// ä½¿ç”¨Redisç¼“å­˜çƒ­é—¨æœŸå·çš„çƒ­æ¸©å†·æ•°æ®
// TTL: 1å°æ—¶ï¼Œè‡ªåŠ¨è¿‡æœŸ
const cacheKey = `hwc:${baseIssue}:${targetIssue}`;
let hwcData = await redis.get(cacheKey);

if (!hwcData) {
  // å®æ—¶è®¡ç®—å¹¶ç¼“å­˜
  hwcData = await calculateHotWarmColdData(baseIssue, targetIssue);
  await redis.setex(cacheKey, 3600, JSON.stringify(hwcData));
}
```

**ä¼˜åŠ¿**:
- é‡Šæ”¾5.3GB MongoDBå­˜å‚¨
- çƒ­é—¨æŸ¥è¯¢ä»ç„¶å¿«é€Ÿ (Rediså†…å­˜è®¿é—®)

**åŠ£åŠ¿**:
- éœ€è¦å®‰è£…Redis
- é¦–æ¬¡æŸ¥è¯¢å˜æ…¢ (å®æ—¶è®¡ç®—)
- å†·é—¨æœŸå·æ¯æ¬¡éƒ½è¦è®¡ç®—

---

#### ç­–ç•¥B2: æŒ‰éœ€ç”Ÿæˆ + LRUç¼“å­˜
```javascript
// ä½¿ç”¨Node.jsçš„LRUç¼“å­˜ (å¦‚ lru-cache)
const cache = new LRUCache({
  max: 100,  // æœ€å¤šç¼“å­˜100æœŸæ•°æ®
  maxSize: 500 * 1024 * 1024,  // æœ€å¤§500MB
  sizeCalculation: (value) => JSON.stringify(value).length
});

async function getHotWarmColdData(baseIssue, targetIssue) {
  const key = `${baseIssue}:${targetIssue}`;

  if (cache.has(key)) {
    return cache.get(key);
  }

  // å®æ—¶è®¡ç®—
  const data = await calculateHotWarmColdData(baseIssue, targetIssue);
  cache.set(key, data);
  return data;
}
```

**ä¼˜åŠ¿**:
- æ— éœ€å¤–éƒ¨ä¾èµ–
- è‡ªåŠ¨æ·˜æ±°ä¸å¸¸ç”¨æ•°æ®
- å†…å­˜å ç”¨å¯æ§ (æœ€å¤š500MB)

**åŠ£åŠ¿**:
- åº”ç”¨é‡å¯åç¼“å­˜ä¸¢å¤±
- å¹¶å‘è¯·æ±‚å¯èƒ½é‡å¤è®¡ç®—

---

#### ç­–ç•¥B3: åˆ†æœŸå­˜å‚¨ + å»¶è¿ŸåŠ è½½
```javascript
// ä¸åœ¨ä¸€ä¸ªæ–‡æ¡£å­˜å‚¨æ‰€æœ‰ç»„åˆIDï¼Œæ”¹ä¸ºæŒ‰çƒ­æ¸©å†·æ¯”åˆ†åˆ«å­˜å‚¨
{
  base_issue: "7001",
  target_issue: "7002",
  ratio: "3:2:0",  // å•ä¸ªçƒ­æ¸©å†·æ¯”
  combination_ids: [1, 15, 89, ...],  // è¯¥æ¯”ä¾‹çš„ç»„åˆID
  count: 78456
}

// æŸ¥è¯¢æ—¶åªåŠ è½½éœ€è¦çš„çƒ­æ¸©å†·æ¯”
const ratiosToQuery = ["3:2:0", "2:2:1", "2:3:0"];
const hwcDocs = await HWCTable.find({
  base_issue: "7001",
  target_issue: "7002",
  ratio: { $in: ratiosToQuery }
});
```

**ä¼˜åŠ¿**:
- ä»ç„¶ä½¿ç”¨MongoDB (æ— éœ€Redis)
- æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘å•æ¬¡æŸ¥è¯¢æ•°æ®é‡
- æ€»å­˜å‚¨ç©ºé—´ç›¸åŒï¼Œä½†æŸ¥è¯¢æ›´çµæ´»

**åŠ£åŠ¿**:
- æ–‡æ¡£æ•°é‡å¤§å¹…å¢åŠ  (2,788 â†’ çº¦50,000)
- éœ€è¦é‡æ„æ•°æ®ç”Ÿæˆé€»è¾‘
- ç´¢å¼•ç»´æŠ¤æˆæœ¬å¢åŠ 

---

### æ–¹æ¡ˆBçš„æ•´ä½“è¯„ä¼°

| ç­–ç•¥ | é‡Šæ”¾ç©ºé—´ | æŸ¥è¯¢é€Ÿåº¦ | å¼€å‘æˆæœ¬ | è¿ç»´æˆæœ¬ | é£é™©ç­‰çº§ |
|------|---------|---------|---------|---------|---------|
| **B1: Redisç¼“å­˜** | 5.3 GB | é¦–æ¬¡æ…¢ï¼Œåç»­å¿« | ä¸­ | é«˜ (éœ€ç»´æŠ¤Redis) | ğŸŸ¡ ä¸­ |
| **B2: LRUç¼“å­˜** | 5.3 GB | é¦–æ¬¡æ…¢ï¼Œåç»­å¿« | ä½ | ä½ | ğŸŸ¢ ä½ |
| **B3: åˆ†æœŸå­˜å‚¨** | 0 GB | ç•¥æ…¢ | é«˜ | ä¸­ | ğŸŸ¡ ä¸­ |

**âš ï¸ æ‰¹é‡é¢„æµ‹æ€§èƒ½å½±å“**:

| åœºæ™¯ | å½“å‰ (ä¼˜åŒ–è¡¨) | B1 (Redis) | B2 (LRU) | B3 (åˆ†æœŸ) |
|------|-------------|-----------|---------|----------|
| é¢„æµ‹1æœŸ (çƒ­é—¨) | 0.5s | 0.5s (ç¼“å­˜å‘½ä¸­) | 0.5s (ç¼“å­˜å‘½ä¸­) | 0.8s |
| é¢„æµ‹1æœŸ (å†·é—¨) | 0.5s | 3-5s (å®æ—¶è®¡ç®—) | 3-5s (å®æ—¶è®¡ç®—) | 0.8s |
| é¢„æµ‹20æœŸ | 10s | 15-60s (å¤šæ¬¡å®æ—¶è®¡ç®—) | 15-60s (å¤šæ¬¡å®æ—¶è®¡ç®—) | 16s |
| é¢„æµ‹100æœŸ | 50s | 300s+ (å¤§é‡å®æ—¶è®¡ç®—) | 300s+ (å¤§é‡å®æ—¶è®¡ç®—) | 80s |

**ç»“è®º**: æ–¹æ¡ˆBä¼šæ˜¾è‘—é™ä½æ‰¹é‡é¢„æµ‹æ€§èƒ½ âŒ

---

## ğŸ¯ æœ€ç»ˆæ¨èæ–¹æ¡ˆ

### æ¨è: æ–¹æ¡ˆA (ä¿å®ˆä¼˜åŒ–)

**ç†ç”±**:
1. âœ… **ä¿ç•™æ ¸å¿ƒä¼˜åŒ–**: çƒ­æ¸©å†·æ¯”é¢„å¤„ç†è¡¨æ˜¯è§£å†³æ‰¹é‡é¢„æµ‹æ€§èƒ½çš„å…³é”®
2. âœ… **æ˜¾è‘—å‡å°‘å†…å­˜**: ä»å¯å‡å°‘50%å†…å­˜å ç”¨ (9.2GB â†’ 4-5GB)
3. âœ… **é›¶åŠŸèƒ½å½±å“**: æ‰¹é‡é¢„æµ‹æ€§èƒ½ä¿æŒä¸å˜
4. âœ… **ä½é£é™©**: ä¸æ¶‰åŠæ ¸å¿ƒé€»è¾‘æ”¹åŠ¨
5. âœ… **å¿«é€Ÿå®æ–½**: 1-2å°æ—¶å³å¯å®Œæˆ

**ä¸å»ºè®®æ–¹æ¡ˆBçš„åŸå› **:
1. âŒ **è¿èƒŒåŸè®¾è®¡åˆè¡·**: å½“åˆå°±æ˜¯å› ä¸ºå®æ—¶è®¡ç®—å¤ªæ…¢æ‰åšçš„é¢„å¤„ç†ä¼˜åŒ–
2. âŒ **æ‰¹é‡é¢„æµ‹æ€§èƒ½ä¸‹é™**: 20æœŸä»10ç§’é€€åŒ–åˆ°15-60ç§’
3. âŒ **å¼€å‘æˆæœ¬é«˜**: éœ€è¦é‡æ„å¤§é‡ä»£ç å¹¶å……åˆ†æµ‹è¯•
4. âŒ **æ€§ä»·æ¯”ä½**: é‡Šæ”¾5.3GBç©ºé—´çš„ä»£ä»·å¤ªå¤§

---

## ğŸ“‹ æ–¹æ¡ˆAè¯¦ç»†å®æ–½æ­¥éª¤

### ç¬¬ä¸€æ­¥: åˆ é™¤å†—ä½™ç´¢å¼• (15åˆ†é’Ÿ)

```javascript
// è¿æ¥åˆ°MongoDB
use lottery

// åˆ é™¤hit_dlt_redcombinationsçš„å†—ä½™ç´¢å¼•
db.hit_dlt_redcombinations.dropIndex("sum_1")
db.hit_dlt_redcombinations.dropIndex("sumRange_1")
db.hit_dlt_redcombinations.dropIndex("zoneRatio_1")
db.hit_dlt_redcombinations.dropIndex("evenOddRatio_1")
db.hit_dlt_redcombinations.dropIndex("consecutiveCount_1")
db.hit_dlt_redcombinations.dropIndex("consecutive_groups_1")
db.hit_dlt_redcombinations.dropIndex("max_consecutive_length_1")

// ä¿ç•™çš„æœ‰æ•ˆç´¢å¼•:
// - _id
// - combination_id
// - sum_value (æ–°)
// - span_value
// - zone_ratio (æ–°)
// - odd_even_ratio (æ–°)
// - combo_2, combo_3, combo_4
// - acValue
```

**é¢„æœŸæ•ˆæœ**: é‡Šæ”¾çº¦15 MBï¼Œå‡å°‘å†™å…¥å¼€é”€

---

### ç¬¬äºŒæ­¥: ä¼˜åŒ–æ’é™¤è¯¦æƒ…ç´¢å¼• (30åˆ†é’Ÿ)

```javascript
// åˆ é™¤ä¸å¸¸ç”¨çš„æ¡ä»¶å­—æ®µç´¢å¼•
db.hit_dlt_exclusiondetails.dropIndex("sum_condition_1")
db.hit_dlt_exclusiondetails.dropIndex("span_condition_1")
db.hit_dlt_exclusiondetails.dropIndex("zone_ratio_condition_1")
db.hit_dlt_exclusiondetails.dropIndex("odd_even_ratio_condition_1")
db.hit_dlt_exclusiondetails.dropIndex("hot_warm_cold_condition_1")

// ä¿ç•™æ ¸å¿ƒç´¢å¼•:
// - _id
// - task_id (å¸¸ç”¨æŸ¥è¯¢)
// - issue_pair (å¸¸ç”¨æŸ¥è¯¢)
// - created_at (ç”¨äºæ¸…ç†æ—§æ•°æ®)
```

**é¢„æœŸæ•ˆæœ**: é‡Šæ”¾çº¦1.5 GB

---

### ç¬¬ä¸‰æ­¥: ä¿®å¤è¿æ¥æ± é…ç½® (15åˆ†é’Ÿ)

ç¼–è¾‘ `src/database/config.js`:

```javascript
// ä¿®æ”¹å‰
mongoose.connect(MONGODB_URI);

// ä¿®æ”¹å
mongoose.connect(MONGODB_URI, {
  maxPoolSize: 10,        // é™åˆ¶æœ€å¤§è¿æ¥æ•°ä¸º10
  minPoolSize: 2,         // æœ€å°è¿æ¥æ•°2
  serverSelectionTimeoutMS: 5000,
  socketTimeoutMS: 45000,
  family: 4               // å¼ºåˆ¶ä½¿ç”¨IPv4
});
```

**é¢„æœŸæ•ˆæœ**: è¿æ¥æ•°ä»303é™è‡³10-20

---

### ç¬¬å››æ­¥: é…ç½®WiredTigerç¼“å­˜é™åˆ¶ (30åˆ†é’Ÿ)

æ‰¾åˆ°MongoDBé…ç½®æ–‡ä»¶ (é€šå¸¸åœ¨ `C:\Program Files\MongoDB\Server\<version>\bin\mongod.cfg`)

æ·»åŠ æˆ–ä¿®æ”¹:

```yaml
storage:
  wiredTiger:
    engineConfig:
      cacheSizeGB: 4  # é™åˆ¶ç¼“å­˜ä¸º4GB (åŸ15.8GB)
```

é‡å¯MongoDBæœåŠ¡:
```powershell
net stop MongoDB
net start MongoDB
```

**é¢„æœŸæ•ˆæœ**: WiredTigerç¼“å­˜ä»15.8GBé™è‡³4GB

---

### ç¬¬äº”æ­¥: æ¸…ç†æ—§æ’é™¤è¯¦æƒ…æ•°æ® (å¯é€‰)

```javascript
// åˆ é™¤30å¤©å‰çš„æ’é™¤è¯¦æƒ…è®°å½•
const cutoffDate = new Date();
cutoffDate.setDate(cutoffDate.getDate() - 30);

db.hit_dlt_exclusiondetails.deleteMany({
  created_at: { $lt: cutoffDate }
});

// æŸ¥çœ‹åˆ é™¤ç»“æœ
db.hit_dlt_exclusiondetails.countDocuments()
```

**é¢„æœŸæ•ˆæœ**: è¿›ä¸€æ­¥å‡å°‘æ•°æ®å¤§å°

---

## ğŸ“Š ä¼˜åŒ–åé¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å (æ–¹æ¡ˆA) | æ”¹å–„ |
|------|--------|---------------|------|
| MongoDBå†…å­˜å ç”¨ | 9.2 GB | 4-5 GB | â¬‡ï¸ 50% |
| è¿æ¥æ•° | 303 | 10-20 | â¬‡ï¸ 95% |
| ç´¢å¼•å¤§å° | 3.7 GB | 2.2 GB | â¬‡ï¸ 40% |
| æ‰¹é‡é¢„æµ‹æ€§èƒ½ | 10ç§’/20æœŸ | 10ç§’/20æœŸ | âœ… ä¸å˜ |
| åŠŸèƒ½å®Œæ•´æ€§ | 100% | 100% | âœ… æ— å½±å“ |

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### å…³äºçƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨

**è¯·å‹¿åˆ é™¤æ­¤è¡¨ï¼** ç†ç”±:

1. **å†å²èƒŒæ™¯**: å½“åˆå°±æ˜¯å› ä¸ºå®æ—¶è®¡ç®—å¯¼è‡´"æ‰¹é‡é¢„æµ‹å¤šæœŸæ—¶å†…å­˜ä¸è¶³ã€è¿è¡Œæ…¢"
2. **æ€§èƒ½å·®å¼‚**:
   - æœ‰ä¼˜åŒ–è¡¨: 0.5-1ç§’/æœŸ
   - æ— ä¼˜åŒ–è¡¨: 3-5ç§’/æœŸ (å®æ—¶è®¡ç®—)
   - æ‰¹é‡20æœŸ: 10ç§’ vs 60ç§’+
3. **ç”¨æˆ·ä½“éªŒ**: æ‰¹é‡é¢„æµ‹æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œæ€§èƒ½é€€åŒ–ä¸å¯æ¥å—
4. **å­˜å‚¨æˆæœ¬**: 9GBå­˜å‚¨ç©ºé—´æ¢å–5-10å€æ€§èƒ½æå‡ï¼Œæ˜¯å€¼å¾—çš„

### å¦‚æœå®åœ¨éœ€è¦é‡Šæ”¾ç©ºé—´

**æ›¿ä»£æ–¹æ¡ˆ**: åªä¿ç•™æœ€è¿‘200æœŸçš„çƒ­æ¸©å†·æ•°æ®

```javascript
// æŸ¥è¯¢æœ€æ–°æœŸå·
const latestIssue = await hit_dlts.findOne().sort({ Issue: -1 });

// è®¡ç®—200æœŸå‰çš„æœŸå·
const cutoffIssue = (parseInt(latestIssue.Issue) - 200).toString();

// åˆ é™¤æ—§æ•°æ®
await DLTRedCombinationsHotWarmColdOptimized.deleteMany({
  target_issue: { $lt: cutoffIssue }
});
```

**æ•ˆæœ**:
- ä»2,788æœŸé™è‡³200æœŸ
- å­˜å‚¨ä»9.1GBé™è‡³çº¦650MB
- é‡Šæ”¾çº¦8.5GBç©ºé—´
- å¸¸ç”¨æ•°æ®ä»ç„¶ä¿ç•™

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### è¯·ç¡®è®¤ä»¥ä¸‹é—®é¢˜:

1. **æ˜¯å¦æ‰§è¡Œæ–¹æ¡ˆA (ä¿å®ˆä¼˜åŒ–)?**
   - [ ] æ˜¯ï¼Œæ‰§è¡Œå…¨éƒ¨5ä¸ªæ­¥éª¤ (æ¨è)
   - [ ] æ˜¯ï¼Œä½†è·³è¿‡WiredTigerç¼“å­˜é™åˆ¶
   - [ ] å¦ï¼Œæˆ‘æƒ³è€ƒè™‘æ–¹æ¡ˆB

2. **æ˜¯å¦æ¸…ç†æ—§çš„çƒ­æ¸©å†·æ•°æ® (åªä¿ç•™200æœŸ)?**
   - [ ] æ˜¯ï¼Œé‡Šæ”¾8.5GBç©ºé—´
   - [ ] å¦ï¼Œä¿ç•™å…¨éƒ¨2,788æœŸæ•°æ®

3. **æ˜¯å¦éœ€è¦å¤‡ä»½æ•°æ®åº“?**
   - [ ] æ˜¯ï¼Œå…ˆå¤‡ä»½å†ä¼˜åŒ– (æ¨è)
   - [ ] å¦ï¼Œç›´æ¥ä¼˜åŒ–

4. **æ˜¯å¦éœ€è¦æˆ‘ç”Ÿæˆå¯æ‰§è¡Œçš„ä¼˜åŒ–è„šæœ¬?**
   - [ ] æ˜¯ï¼Œç”ŸæˆNode.jsè„šæœ¬
   - [ ] æ˜¯ï¼Œç”ŸæˆMongoDB Shellè„šæœ¬
   - [ ] å¦ï¼Œæˆ‘æ‰‹åŠ¨æ‰§è¡Œ

---

## ğŸ“ æ€»ç»“

**æ ¸å¿ƒç»“è®º**: çƒ­æ¸©å†·æ¯”ä¼˜åŒ–è¡¨å ç”¨9.1GBæ˜¯**åˆç†çš„æ€§èƒ½ä¼˜åŒ–ä»£ä»·**ï¼Œä¸åº”åˆ é™¤ã€‚

**æ¨èè¡ŒåŠ¨**: æ‰§è¡Œæ–¹æ¡ˆAçš„å…¶ä»–ä¼˜åŒ–æªæ–½ï¼Œå¯å°†å†…å­˜å ç”¨ä»9.2GBé™è‡³4-5GBï¼ŒåŒæ—¶ä¿æŒæ‰¹é‡é¢„æµ‹çš„é«˜æ€§èƒ½ã€‚

**å¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–**: è€ƒè™‘åªä¿ç•™æœ€è¿‘200æœŸçƒ­æ¸©å†·æ•°æ®ï¼Œå¯é¢å¤–é‡Šæ”¾8.5GBç©ºé—´ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025-10-27
**åˆ†æå·¥å…·**: diagnose-mongodb-usage.js
**å¾…ç”¨æˆ·ç¡®è®¤åå®æ–½**
